<!-- livebook:{"persist_outputs":true} -->

# Makemore: Elixir

```elixir
Mix.install([
  {:nx, "~> 0.10.0"},
  {:tucan, "~> 0.5.1"},
  {:kino_vega_lite, "~> 0.1.13"},
  {:exla, "~> 0.10.0"},
  {:axon, "~> 0.8.0"}
])
```

## Introduction

Now that we have an understanding over how a neural network functions we can start learning how to work with text and working our way towards understanding transformers.

```elixir
names =
  File.read!(__DIR__ <> "/data/names.txt")
  |> String.split("\n")
```

<!-- livebook:{"output":true} -->

```
["emma", "olivia", "ava", "isabella", "sophia", "charlotte", "mia", "amelia", "harper", "evelyn",
 "abigail", "emily", "elizabeth", "mila", "ella", "avery", "sofia", "camila", "aria", "scarlett",
 "victoria", "madison", "luna", "grace", "chloe", "penelope", "layla", "riley", "zoey", "nora",
 "lily", "eleanor", "hannah", "lillian", "addison", "aubrey", "ellie", "stella", "natalie", "zoe",
 "leah", "hazel", "violet", "aurora", "savannah", "audrey", "brooklyn", "bella", "claire", "skylar",
 ...]
```

```elixir
IO.write("""
#{length(names)} examples in dataset
shortest name: #{Enum.min_by(names, &String.length/1) |> String.length()}
longest name: #{Enum.max_by(names, &String.length/1) |> String.length()}
""")
```

<!-- livebook:{"output":true} -->

```
32033 examples in dataset
shortest name: 2
longest name: 15
```

<!-- livebook:{"output":true} -->

```
:ok
```

Our goal is to create a system that can predict the next token (or single character) when given some text as input. We'll start with simple models and slowly build them up to a transformer and then onto GPT and nanochat.

1. Simple bigram model
2. MLP bigram
3. TBC

## Simple bigram model

To begin with we can build a statistical model based on the liklihood of a character coming next. We can break up the list of names that we've imported into pairs of characters, showing which character we start with, and which character then followed.

So for example `anna` would become:

```
['.', 'a'],
['a', 'n'],
['n', 'n'],
['n', 'a'],
['a', '.']
```

The `.` character signifies either the beginning or end of the word.

This gives us five bigrams from the one word. If we go through every word in the dataset and break them down into the bigrams from start to finish we can the count up the number of times we see each of the bigrams appear.

```elixir
defmodule Bigram do
  def from_string(str, opts \\ []) do
    block_size = Keyword.get(opts, :block_size, 1)
    start_end_char = "."
    prepend = List.duplicate(".", block_size) |> to_string()

    prepend <> str <> start_end_char
    |> String.split("", trim: true)
    |> Enum.chunk_every(block_size + 1, 1, :discard)
  end
end

bigram_count =
  names
  |> Enum.flat_map(&Bigram.from_string/1)
  |> Enum.reduce(%{}, fn bigram, acc -> Map.update(acc, bigram, 1, & &1 + 1) end)

IO.write("Number of unique bigrams: #{Map.to_list(bigram_count) |> length()}")

Enum.sort_by(bigram_count, &elem(&1, 1), :desc)
```

<!-- livebook:{"output":true} -->

```
Number of unique bigrams: 627
```

<!-- livebook:{"output":true} -->

```
[
  {["n", "."], 6763},
  {["a", "."], 6640},
  {["a", "n"], 5438},
  {[".", "a"], 4410},
  {["e", "."], 3983},
  {["a", "r"], 3264},
  {["e", "l"], 3248},
  {["r", "i"], 3033},
  {["n", "a"], 2977},
  {[".", "k"], 2963},
  {["l", "e"], 2921},
  {["e", "n"], 2675},
  {["l", "a"], 2623},
  {["m", "a"], 2590},
  {[".", "m"], 2538},
  {["a", "l"], 2528},
  {["i", "."], 2489},
  {["l", "i"], 2480},
  {["i", "a"], 2445},
  {[".", "j"], 2422},
  {["o", "n"], 2411},
  {["h", "."], 2409},
  {["r", "a"], 2356},
  {["a", "h"], 2332},
  {["h", "a"], 2244},
  {["y", "a"], 2143},
  {["i", "n"], 2126},
  {[".", "s"], 2055},
  {["a", "y"], 2050},
  {["y", "."], 2007},
  {["e", "r"], 1958},
  {["n", "n"], 1906},
  {["y", "n"], 1826},
  {["k", "a"], 1731},
  {["n", "i"], 1725},
  {["r", "e"], 1697},
  {[".", "d"], 1690},
  {["i", "e"], 1653},
  {["a", "i"], 1650},
  {[".", "r"], 1639},
  {["a", "m"], 1634},
  {["l", "y"], 1588},
  {[".", "l"], 1572},
  {[".", "c"], 1542},
  {[".", "e"], 1531},
  {["j", "a"], 1473},
  {["r", "."], 1377},
  {["n", ...], 1359},
  {[...], ...},
  {...},
  ...
]
```

We can quickly see that it's very likely for a word to end with `n` or `a`, and the bigram `[a, n]` is very likely to appear somewhere within the words.

We can visualise all of the possible bigrams and what is most common using a heatmap built with `Tucan`.

```elixir
chars =
  Enum.concat([?.], ?a..?z)
  |> List.to_string
  |> String.graphemes()

for x <- chars, y <- chars do
  %{
    "first_character" => x,
    "second_character" => y,
    "occurrence_count" => bigram_count[[x, y]] || 0
  }
end
|> Tucan.heatmap(
  "second_character",
  "first_character",
  "occurrence_count",
  annotate: true,
  tooltip: true,
  aggregate: :sum,
  color: [legend: false],
  x: [axis: [orient: :top, label_angle: 0]]
)
|> Tucan.set_theme(:power_bi)
|> Tucan.set_width(800)
```

<!-- livebook:{"output":true} -->

```vega-lite
{"$schema":"https://vega.github.io/schema/vega-lite/v5.json","__tucan__":{"multilayer":true,"types":{"first_character":"nominal","occurrence_count":"quantitative","second_character":"nominal"}},"config":{"arc":{"fill":"#118DFF"},"area":{"fill":"#118DFF","line":true,"opacity":0.6},"axis":{"domain":false,"grid":false,"labelColor":"#605E5C","labelFontSize":12.0,"ticks":false,"titleColor":"#252423","titleFont":"wf_standard-font, helvetica, arial, sans-serif","titleFontSize":16.0,"titleFontWeight":"normal"},"axisBand":{"tickExtra":true},"axisQuantitative":{"grid":true,"gridColor":"#c8C6C4","gridDash":[1,5],"labelFlush":false,"tickCount":3},"axisX":{"labelPadding":5},"axisY":{"labelPadding":10},"background":"transparent","bar":{"fill":"#118DFF"},"font":"segoe uI","header":{"labelColor":"#605E5C","labelFont":"segoe uI","labelFontSize":13.333333333333332,"titleColor":"#252423","titleFont":"wf_standard-font, helvetica, arial, sans-serif","titleFontSize":16.0},"legend":{"labelColor":"#605E5C","labelFont":"segoe uI","labelFontSize":13.333333333333332,"symbolSize":75,"symbolType":"circle","titleColor":"#605E5C","titleFont":"segoe uI","titleFontWeight":"bold"},"line":{"stroke":"#118DFF","strokeCap":"round","strokeJoin":"round","strokeWidth":3},"path":{"stroke":"#118DFF"},"point":{"fill":"#118DFF","filled":true,"size":75},"range":{"category":["#118DFF","#12239E","#e66C37","#6B007B","#e044A7","#744EC2","#d9B300","#d64550"],"diverging":["#dEEFFF","#118DFF"],"heatmap":["#dEEFFF","#118DFF"],"ordinal":["#dEEFFF","#c7e4ff","#b0d9ff","#9aceff","#83c3ff","#6cb9ff","#55aeff","#3fa3ff","#2898ff","#118DFF"]},"rect":{"fill":"#118DFF"},"shape":{"stroke":"#118DFF"},"symbol":{"fill":"#118DFF","size":50,"strokeWidth":1.5},"text":{"fill":"#605E5C","font":"segoe uI","fontSize":12.0},"view":{"stroke":"transparent"}},"data":{"values":[{"first_character":".","occurrence_count":0,"second_character":"."},{"first_character":".","occurrence_count":4410,"second_character":"a"},{"first_character":".","occurrence_count":1306,"second_character":"b"},{"first_character":".","occurrence_count":1542,"second_character":"c"},{"first_character":".","occurrence_count":1690,"second_character":"d"},{"first_character":".","occurrence_count":1531,"second_character":"e"},{"first_character":".","occurrence_count":417,"second_character":"f"},{"first_character":".","occurrence_count":669,"second_character":"g"},{"first_character":".","occurrence_count":874,"second_character":"h"},{"first_character":".","occurrence_count":591,"second_character":"i"},{"first_character":".","occurrence_count":2422,"second_character":"j"},{"first_character":".","occurrence_count":2963,"second_character":"k"},{"first_character":".","occurrence_count":1572,"second_character":"l"},{"first_character":".","occurrence_count":2538,"second_character":"m"},{"first_character":".","occurrence_count":1146,"second_character":"n"},{"first_character":".","occurrence_count":394,"second_character":"o"},{"first_character":".","occurrence_count":515,"second_character":"p"},{"first_character":".","occurrence_count":92,"second_character":"q"},{"first_character":".","occurrence_count":1639,"second_character":"r"},{"first_character":".","occurrence_count":2055,"second_character":"s"},{"first_character":".","occurrence_count":1308,"second_character":"t"},{"first_character":".","occurrence_count":78,"second_character":"u"},{"first_character":".","occurrence_count":376,"second_character":"v"},{"first_character":".","occurrence_count":307,"second_character":"w"},{"first_character":".","occurrence_count":134,"second_character":"x"},{"first_character":".","occurrence_count":535,"second_character":"y"},{"first_character":".","occurrence_count":929,"second_character":"z"},{"first_character":"a","occurrence_count":6640,"second_character":"."},{"first_character":"a","occurrence_count":556,"second_character":"a"},{"first_character":"a","occurrence_count":541,"second_character":"b"},{"first_character":"a","occurrence_count":470,"second_character":"c"},{"first_character":"a","occurrence_count":1042,"second_character":"d"},{"first_character":"a","occurrence_count":692,"second_character":"e"},{"first_character":"a","occurrence_count":134,"second_character":"f"},{"first_character":"a","occurrence_count":168,"second_character":"g"},{"first_character":"a","occurrence_count":2332,"second_character":"h"},{"first_character":"a","occurrence_count":1650,"second_character":"i"},{"first_character":"a","occurrence_count":175,"second_character":"j"},{"first_character":"a","occurrence_count":568,"second_character":"k"},{"first_character":"a","occurrence_count":2528,"second_character":"l"},{"first_character":"a","occurrence_count":1634,"second_character":"m"},{"first_character":"a","occurrence_count":5438,"second_character":"n"},{"first_character":"a","occurrence_count":63,"second_character":"o"},{"first_character":"a","occurrence_count":82,"second_character":"p"},{"first_character":"a","occurrence_count":60,"second_character":"q"},{"first_character":"a","occurrence_count":3264,"second_character":"r"},{"first_character":"a","occurrence_count":1118,"second_character":"s"},{"first_character":"a","occurrence_count":687,"second_character":"t"},{"first_character":"a","occurrence_count":381,"second_character":"u"},{"first_character":"a","occurrence_count":834,"second_character":"v"},{"first_character":"a","occurrence_count":161,"second_character":"w"},{"first_character":"a","occurrence_count":182,"second_character":"x"},{"first_character":"a","occurrence_count":2050,"second_character":"y"},{"first_character":"a","occurrence_count":435,"second_character":"z"},{"first_character":"b","occurrence_count":114,"second_character":"."},{"first_character":"b","occurrence_count":321,"second_character":"a"},{"first_character":"b","occurrence_count":38,"second_character":"b"},{"first_character":"b","occurrence_count":1,"second_character":"c"},{"first_character":"b","occurrence_count":65,"second_character":"d"},{"first_character":"b","occurrence_count":655,"second_character":"e"},{"first_character":"b","occurrence_count":0,"second_character":"f"},{"first_character":"b","occurrence_count":0,"second_character":"g"},{"first_character":"b","occurrence_count":41,"second_character":"h"},{"first_character":"b","occurrence_count":217,"second_character":"i"},{"first_character":"b","occurrence_count":1,"second_character":"j"},{"first_character":"b","occurrence_count":0,"second_character":"k"},{"first_character":"b","occurrence_count":103,"second_character":"l"},{"first_character":"b","occurrence_count":0,"second_character":"m"},{"first_character":"b","occurrence_count":4,"second_character":"n"},{"first_character":"b","occurrence_count":105,"second_character":"o"},{"first_character":"b","occurrence_count":0,"second_character":"p"},{"first_character":"b","occurrence_count":0,"second_character":"q"},{"first_character":"b","occurrence_count":842,"second_character":"r"},{"first_character":"b","occurrence_count":8,"second_character":"s"},{"first_character":"b","occurrence_count":2,"second_character":"t"},{"first_character":"b","occurrence_count":45,"second_character":"u"},{"first_character":"b","occurrence_count":0,"second_character":"v"},{"first_character":"b","occurrence_count":0,"second_character":"w"},{"first_character":"b","occurrence_count":0,"second_character":"x"},{"first_character":"b","occurrence_count":83,"second_character":"y"},{"first_character":"b","occurrence_count":0,"second_character":"z"},{"first_character":"c","occurrence_count":97,"second_character":"."},{"first_character":"c","occurrence_count":815,"second_character":"a"},{"first_character":"c","occurrence_count":0,"second_character":"b"},{"first_character":"c","occurrence_count":42,"second_character":"c"},{"first_character":"c","occurrence_count":1,"second_character":"d"},{"first_character":"c","occurrence_count":551,"second_character":"e"},{"first_character":"c","occurrence_count":0,"second_character":"f"},{"first_character":"c","occurrence_count":2,"second_character":"g"},{"first_character":"c","occurrence_count":664,"second_character":"h"},{"first_character":"c","occurrence_count":271,"second_character":"i"},{"first_character":"c","occurrence_count":3,"second_character":"j"},{"first_character":"c","occurrence_count":316,"second_character":"k"},{"first_character":"c","occurrence_count":116,"second_character":"l"},{"first_character":"c","occurrence_count":0,"second_character":"m"},{"first_character":"c","occurrence_count":0,"second_character":"n"},{"first_character":"c","occurrence_count":380,"second_character":"o"},{"first_character":"c","occurrence_count":1,"second_character":"p"},{"first_character":"c","occurrence_count":11,"second_character":"q"},{"first_character":"c","occurrence_count":76,"second_character":"r"},{"first_character":"c","occurrence_count":5,"second_character":"s"},{"first_character":"c","occurrence_count":35,"second_character":"t"},{"first_character":"c","occurrence_count":35,"second_character":"u"},{"first_character":"c","occurrence_count":0,"second_character":"v"},{"first_character":"c","occurrence_count":0,"second_character":"w"},{"first_character":"c","occurrence_count":3,"second_character":"x"},{"first_character":"c","occurrence_count":104,"second_character":"y"},{"first_character":"c","occurrence_count":4,"second_character":"z"},{"first_character":"d","occurrence_count":516,"second_character":"."},{"first_character":"d","occurrence_count":1303,"second_character":"a"},{"first_character":"d","occurrence_count":1,"second_character":"b"},{"first_character":"d","occurrence_count":3,"second_character":"c"},{"first_character":"d","occurrence_count":149,"second_character":"d"},{"first_character":"d","occurrence_count":1283,"second_character":"e"},{"first_character":"d","occurrence_count":5,"second_character":"f"},{"first_character":"d","occurrence_count":25,"second_character":"g"},{"first_character":"d","occurrence_count":118,"second_character":"h"},{"first_character":"d","occurrence_count":674,"second_character":"i"},{"first_character":"d","occurrence_count":9,"second_character":"j"},{"first_character":"d","occurrence_count":3,"second_character":"k"},{"first_character":"d","occurrence_count":60,"second_character":"l"},{"first_character":"d","occurrence_count":30,"second_character":"m"},{"first_character":"d","occurrence_count":31,"second_character":"n"},{"first_character":"d","occurrence_count":378,"second_character":"o"},{"first_character":"d","occurrence_count":0,"second_character":"p"},{"first_character":"d","occurrence_count":1,"second_character":"q"},{"first_character":"d","occurrence_count":424,"second_character":"r"},{"first_character":"d","occurrence_count":29,"second_character":"s"},{"first_character":"d","occurrence_count":4,"second_character":"t"},{"first_character":"d","occurrence_count":92,"second_character":"u"},{"first_character":"d","occurrence_count":17,"second_character":"v"},{"first_character":"d","occurrence_count":23,"second_character":"w"},{"first_character":"d","occurrence_count":0,"second_character":"x"},{"first_character":"d","occurrence_count":317,"second_character":"y"},{"first_character":"d","occurrence_count":1,"second_character":"z"},{"first_character":"e","occurrence_count":3983,"second_character":"."},{"first_character":"e","occurrence_count":679,"second_character":"a"},{"first_character":"e","occurrence_count":121,"second_character":"b"},{"first_character":"e","occurrence_count":153,"second_character":"c"},{"first_character":"e","occurrence_count":384,"second_character":"d"},{"first_character":"e","occurrence_count":1271,"second_character":"e"},{"first_character":"e","occurrence_count":82,"second_character":"f"},{"first_character":"e","occurrence_count":125,"second_character":"g"},{"first_character":"e","occurrence_count":152,"second_character":"h"},{"first_character":"e","occurrence_count":818,"second_character":"i"},{"first_character":"e","occurrence_count":55,"second_character":"j"},{"first_character":"e","occurrence_count":178,"second_character":"k"},{"first_character":"e","occurrence_count":3248,"second_character":"l"},{"first_character":"e","occurrence_count":769,"second_character":"m"},{"first_character":"e","occurrence_count":2675,"second_character":"n"},{"first_character":"e","occurrence_count":269,"second_character":"o"},{"first_character":"e","occurrence_count":83,"second_character":"p"},{"first_character":"e","occurrence_count":14,"second_character":"q"},{"first_character":"e","occurrence_count":1958,"second_character":"r"},{"first_character":"e","occurrence_count":861,"second_character":"s"},{"first_character":"e","occurrence_count":580,"second_character":"t"},{"first_character":"e","occurrence_count":69,"second_character":"u"},{"first_character":"e","occurrence_count":463,"second_character":"v"},{"first_character":"e","occurrence_count":50,"second_character":"w"},{"first_character":"e","occurrence_count":132,"second_character":"x"},{"first_character":"e","occurrence_count":1070,"second_character":"y"},{"first_character":"e","occurrence_count":181,"second_character":"z"},{"first_character":"f","occurrence_count":80,"second_character":"."},{"first_character":"f","occurrence_count":242,"second_character":"a"},{"first_character":"f","occurrence_count":0,"second_character":"b"},{"first_character":"f","occurrence_count":0,"second_character":"c"},{"first_character":"f","occurrence_count":0,"second_character":"d"},{"first_character":"f","occurrence_count":123,"second_character":"e"},{"first_character":"f","occurrence_count":44,"second_character":"f"},{"first_character":"f","occurrence_count":1,"second_character":"g"},{"first_character":"f","occurrence_count":1,"second_character":"h"},{"first_character":"f","occurrence_count":160,"second_character":"i"},{"first_character":"f","occurrence_count":0,"second_character":"j"},{"first_character":"f","occurrence_count":2,"second_character":"k"},{"first_character":"f","occurrence_count":20,"second_character":"l"},{"first_character":"f","occurrence_count":0,"second_character":"m"},{"first_character":"f","occurrence_count":4,"second_character":"n"},{"first_character":"f","occurrence_count":60,"second_character":"o"},{"first_character":"f","occurrence_count":0,"second_character":"p"},{"first_character":"f","occurrence_count":0,"second_character":"q"},{"first_character":"f","occurrence_count":114,"second_character":"r"},{"first_character":"f","occurrence_count":6,"second_character":"s"},{"first_character":"f","occurrence_count":18,"second_character":"t"},{"first_character":"f","occurrence_count":10,"second_character":"u"},{"first_character":"f","occurrence_count":0,"second_character":"v"},{"first_character":"f","occurrence_count":4,"second_character":"w"},{"first_character":"f","occurrence_count":0,"second_character":"x"},{"first_character":"f","occurrence_count":14,"second_character":"y"},{"first_character":"f","occurrence_count":2,"second_character":"z"},{"first_character":"g","occurrence_count":108,"second_character":"."},{"first_character":"g","occurrence_count":330,"second_character":"a"},{"first_character":"g","occurrence_count":3,"second_character":"b"},{"first_character":"g","occurrence_count":0,"second_character":"c"},{"first_character":"g","occurrence_count":19,"second_character":"d"},{"first_character":"g","occurrence_count":334,"second_character":"e"},{"first_character":"g","occurrence_count":1,"second_character":"f"},{"first_character":"g","occurrence_count":25,"second_character":"g"},{"first_character":"g","occurrence_count":360,"second_character":"h"},{"first_character":"g","occurrence_count":190,"second_character":"i"},{"first_character":"g","occurrence_count":3,"second_character":"j"},{"first_character":"g","occurrence_count":0,"second_character":"k"},{"first_character":"g","occurrence_count":32,"second_character":"l"},{"first_character":"g","occurrence_count":6,"second_character":"m"},{"first_character":"g","occurrence_count":27,"second_character":"n"},{"first_character":"g","occurrence_count":83,"second_character":"o"},{"first_character":"g","occurrence_count":0,"second_character":"p"},{"first_character":"g","occurrence_count":0,"second_character":"q"},{"first_character":"g","occurrence_count":201,"second_character":"r"},{"first_character":"g","occurrence_count":30,"second_character":"s"},{"first_character":"g","occurrence_count":31,"second_character":"t"},{"first_character":"g","occurrence_count":85,"second_character":"u"},{"first_character":"g","occurrence_count":1,"second_character":"v"},{"first_character":"g","occurrence_count":26,"second_character":"w"},{"first_character":"g","occurrence_count":0,"second_character":"x"},{"first_character":"g","occurrence_count":31,"second_character":"y"},{"first_character":"g","occurrence_count":1,"second_character":"z"},{"first_character":"h","occurrence_count":2409,"second_character":"."},{"first_character":"h","occurrence_count":2244,"second_character":"a"},{"first_character":"h","occurrence_count":8,"second_character":"b"},{"first_character":"h","occurrence_count":2,"second_character":"c"},{"first_character":"h","occurrence_count":24,"second_character":"d"},{"first_character":"h","occurrence_count":674,"second_character":"e"},{"first_character":"h","occurrence_count":2,"second_character":"f"},{"first_character":"h","occurrence_count":2,"second_character":"g"},{"first_character":"h","occurrence_count":1,"second_character":"h"},{"first_character":"h","occurrence_count":729,"second_character":"i"},{"first_character":"h","occurrence_count":9,"second_character":"j"},{"first_character":"h","occurrence_count":29,"second_character":"k"},{"first_character":"h","occurrence_count":185,"second_character":"l"},{"first_character":"h","occurrence_count":117,"second_character":"m"},{"first_character":"h","occurrence_count":138,"second_character":"n"},{"first_character":"h","occurrence_count":287,"second_character":"o"},{"first_character":"h","occurrence_count":1,"second_character":"p"},{"first_character":"h","occurrence_count":1,"second_character":"q"},{"first_character":"h","occurrence_count":204,"second_character":"r"},{"first_character":"h","occurrence_count":31,"second_character":"s"},{"first_character":"h","occurrence_count":71,"second_character":"t"},{"first_character":"h","occurrence_count":166,"second_character":"u"},{"first_character":"h","occurrence_count":39,"second_character":"v"},{"first_character":"h","occurrence_count":10,"second_character":"w"},{"first_character":"h","occurrence_count":0,"second_character":"x"},{"first_character":"h","occurrence_count":213,"second_character":"y"},{"first_character":"h","occurrence_count":20,"second_character":"z"},{"first_character":"i","occurrence_count":2489,"second_character":"."},{"first_character":"i","occurrence_count":2445,"second_character":"a"},{"first_character":"i","occurrence_count":110,"second_character":"b"},{"first_character":"i","occurrence_count":509,"second_character":"c"},{"first_character":"i","occurrence_count":440,"second_character":"d"},{"first_character":"i","occurrence_count":1653,"second_character":"e"},{"first_character":"i","occurrence_count":101,"second_character":"f"},{"first_character":"i","occurrence_count":428,"second_character":"g"},{"first_character":"i","occurrence_count":95,"second_character":"h"},{"first_character":"i","occurrence_count":82,"second_character":"i"},{"first_character":"i","occurrence_count":76,"second_character":"j"},{"first_character":"i","occurrence_count":445,"second_character":"k"},{"first_character":"i","occurrence_count":1345,"second_character":"l"},{"first_character":"i","occurrence_count":427,"second_character":"m"},{"first_character":"i","occurrence_count":2126,"second_character":"n"},{"first_character":"i","occurrence_count":588,"second_character":"o"},{"first_character":"i","occurrence_count":53,"second_character":"p"},{"first_character":"i","occurrence_count":52,"second_character":"q"},{"first_character":"i","occurrence_count":849,"second_character":"r"},{"first_character":"i","occurrence_count":1316,"second_character":"s"},{"first_character":"i","occurrence_count":541,"second_character":"t"},{"first_character":"i","occurrence_count":109,"second_character":"u"},{"first_character":"i","occurrence_count":269,"second_character":"v"},{"first_character":"i","occurrence_count":8,"second_character":"w"},{"first_character":"i","occurrence_count":89,"second_character":"x"},{"first_character":"i","occurrence_count":779,"second_character":"y"},{"first_character":"i","occurrence_count":277,"second_character":"z"},{"first_character":"j","occurrence_count":71,"second_character":"."},{"first_character":"j","occurrence_count":1473,"second_character":"a"},{"first_character":"j","occurrence_count":1,"second_character":"b"},{"first_character":"j","occurrence_count":4,"second_character":"c"},{"first_character":"j","occurrence_count":4,"second_character":"d"},{"first_character":"j","occurrence_count":440,"second_character":"e"},{"first_character":"j","occurrence_count":0,"second_character":"f"},{"first_character":"j","occurrence_count":0,"second_character":"g"},{"first_character":"j","occurrence_count":45,"second_character":"h"},{"first_character":"j","occurrence_count":119,"second_character":"i"},{"first_character":"j","occurrence_count":2,"second_character":"j"},{"first_character":"j","occurrence_count":2,"second_character":"k"},{"first_character":"j","occurrence_count":9,"second_character":"l"},{"first_character":"j","occurrence_count":5,"second_character":"m"},{"first_character":"j","occurrence_count":2,"second_character":"n"},{"first_character":"j","occurrence_count":479,"second_character":"o"},{"first_character":"j","occurrence_count":1,"second_character":"p"},{"first_character":"j","occurrence_count":0,"second_character":"q"},{"first_character":"j","occurrence_count":11,"second_character":"r"},{"first_character":"j","occurrence_count":7,"second_character":"s"},{"first_character":"j","occurrence_count":2,"second_character":"t"},{"first_character":"j","occurrence_count":202,"second_character":"u"},{"first_character":"j","occurrence_count":5,"second_character":"v"},{"first_character":"j","occurrence_count":6,"second_character":"w"},{"first_character":"j","occurrence_count":0,"second_character":"x"},{"first_character":"j","occurrence_count":10,"second_character":"y"},{"first_character":"j","occurrence_count":0,"second_character":"z"},{"first_character":"k","occurrence_count":363,"second_character":"."},{"first_character":"k","occurrence_count":1731,"second_character":"a"},{"first_character":"k","occurrence_count":2,"second_character":"b"},{"first_character":"k","occurrence_count":2,"second_character":"c"},{"first_character":"k","occurrence_count":2,"second_character":"d"},{"first_character":"k","occurrence_count":895,"second_character":"e"},{"first_character":"k","occurrence_count":1,"second_character":"f"},{"first_character":"k","occurrence_count":0,"second_character":"g"},{"first_character":"k","occurrence_count":307,"second_character":"h"},{"first_character":"k","occurrence_count":509,"second_character":"i"},{"first_character":"k","occurrence_count":2,"second_character":"j"},{"first_character":"k","occurrence_count":20,"second_character":"k"},{"first_character":"k","occurrence_count":139,"second_character":"l"},{"first_character":"k","occurrence_count":9,"second_character":"m"},{"first_character":"k","occurrence_count":26,"second_character":"n"},{"first_character":"k","occurrence_count":344,"second_character":"o"},{"first_character":"k","occurrence_count":0,"second_character":"p"},{"first_character":"k","occurrence_count":0,"second_character":"q"},{"first_character":"k","occurrence_count":109,"second_character":"r"},{"first_character":"k","occurrence_count":95,"second_character":"s"},{"first_character":"k","occurrence_count":17,"second_character":"t"},{"first_character":"k","occurrence_count":50,"second_character":"u"},{"first_character":"k","occurrence_count":2,"second_character":"v"},{"first_character":"k","occurrence_count":34,"second_character":"w"},{"first_character":"k","occurrence_count":0,"second_character":"x"},{"first_character":"k","occurrence_count":379,"second_character":"y"},{"first_character":"k","occurrence_count":2,"second_character":"z"},{"first_character":"l","occurrence_count":1314,"second_character":"."},{"first_character":"l","occurrence_count":2623,"second_character":"a"},{"first_character":"l","occurrence_count":52,"second_character":"b"},{"first_character":"l","occurrence_count":25,"second_character":"c"},{"first_character":"l","occurrence_count":138,"second_character":"d"},{"first_character":"l","occurrence_count":2921,"second_character":"e"},{"first_character":"l","occurrence_count":22,"second_character":"f"},{"first_character":"l","occurrence_count":6,"second_character":"g"},{"first_character":"l","occurrence_count":19,"second_character":"h"},{"first_character":"l","occurrence_count":2480,"second_character":"i"},{"first_character":"l","occurrence_count":6,"second_character":"j"},{"first_character":"l","occurrence_count":24,"second_character":"k"},{"first_character":"l","occurrence_count":1345,"second_character":"l"},{"first_character":"l","occurrence_count":60,"second_character":"m"},{"first_character":"l","occurrence_count":14,"second_character":"n"},{"first_character":"l","occurrence_count":692,"second_character":"o"},{"first_character":"l","occurrence_count":15,"second_character":"p"},{"first_character":"l","occurrence_count":3,"second_character":"q"},{"first_character":"l","occurrence_count":18,"second_character":"r"},{"first_character":"l","occurrence_count":94,"second_character":"s"},{"first_character":"l","occurrence_count":77,"second_character":"t"},{"first_character":"l","occurrence_count":324,"second_character":"u"},{"first_character":"l","occurrence_count":72,"second_character":"v"},{"first_character":"l","occurrence_count":16,"second_character":"w"},{"first_character":"l","occurrence_count":0,"second_character":"x"},{"first_character":"l","occurrence_count":1588,"second_character":"y"},{"first_character":"l","occurrence_count":10,"second_character":"z"},{"first_character":"m","occurrence_count":516,"second_character":"."},{"first_character":"m","occurrence_count":2590,"second_character":"a"},{"first_character":"m","occurrence_count":112,"second_character":"b"},{"first_character":"m","occurrence_count":51,"second_character":"c"},{"first_character":"m","occurrence_count":24,"second_character":"d"},{"first_character":"m","occurrence_count":818,"second_character":"e"},{"first_character":"m","occurrence_count":1,"second_character":"f"},{"first_character":"m","occurrence_count":0,"second_character":"g"},{"first_character":"m","occurrence_count":5,"second_character":"h"},{"first_character":"m","occurrence_count":1256,"second_character":"i"},{"first_character":"m","occurrence_count":7,"second_character":"j"},{"first_character":"m","occurrence_count":1,"second_character":"k"},{"first_character":"m","occurrence_count":5,"second_character":"l"},{"first_character":"m","occurrence_count":168,"second_character":"m"},{"first_character":"m","occurrence_count":20,"second_character":"n"},{"first_character":"m","occurrence_count":452,"second_character":"o"},{"first_character":"m","occurrence_count":38,"second_character":"p"},{"first_character":"m","occurrence_count":0,"second_character":"q"},{"first_character":"m","occurrence_count":97,"second_character":"r"},{"first_character":"m","occurrence_count":35,"second_character":"s"},{"first_character":"m","occurrence_count":4,"second_character":"t"},{"first_character":"m","occurrence_count":139,"second_character":"u"},{"first_character":"m","occurrence_count":3,"second_character":"v"},{"first_character":"m","occurrence_count":2,"second_character":"w"},{"first_character":"m","occurrence_count":0,"second_character":"x"},{"first_character":"m","occurrence_count":287,"second_character":"y"},{"first_character":"m","occurrence_count":11,"second_character":"z"},{"first_character":"n","occurrence_count":6763,"second_character":"."},{"first_character":"n","occurrence_count":2977,"second_character":"a"},{"first_character":"n","occurrence_count":8,"second_character":"b"},{"first_character":"n","occurrence_count":213,"second_character":"c"},{"first_character":"n","occurrence_count":704,"second_character":"d"},{"first_character":"n","occurrence_count":1359,"second_character":"e"},{"first_character":"n","occurrence_count":11,"second_character":"f"},{"first_character":"n","occurrence_count":273,"second_character":"g"},{"first_character":"n","occurrence_count":26,"second_character":"h"},{"first_character":"n","occurrence_count":1725,"second_character":"i"},{"first_character":"n","occurrence_count":44,"second_character":"j"},{"first_character":"n","occurrence_count":58,"second_character":"k"},{"first_character":"n","occurrence_count":195,"second_character":"l"},{"first_character":"n","occurrence_count":19,"second_character":"m"},{"first_character":"n","occurrence_count":1906,"second_character":"n"},{"first_character":"n","occurrence_count":496,"second_character":"o"},{"first_character":"n","occurrence_count":5,"second_character":"p"},{"first_character":"n","occurrence_count":2,"second_character":"q"},{"first_character":"n","occurrence_count":44,"second_character":"r"},{"first_character":"n","occurrence_count":278,"second_character":"s"},{"first_character":"n","occurrence_count":443,"second_character":"t"},{"first_character":"n","occurrence_count":96,"second_character":"u"},{"first_character":"n","occurrence_count":55,"second_character":"v"},{"first_character":"n","occurrence_count":11,"second_character":"w"},{"first_character":"n","occurrence_count":6,"second_character":"x"},{"first_character":"n","occurrence_count":465,"second_character":"y"},{"first_character":"n","occurrence_count":145,"second_character":"z"},{"first_character":"o","occurrence_count":855,"second_character":"."},{"first_character":"o","occurrence_count":149,"second_character":"a"},{"first_character":"o","occurrence_count":140,"second_character":"b"},{"first_character":"o","occurrence_count":114,"second_character":"c"},{"first_character":"o","occurrence_count":190,"second_character":"d"},{"first_character":"o","occurrence_count":132,"second_character":"e"},{"first_character":"o","occurrence_count":34,"second_character":"f"},{"first_character":"o","occurrence_count":44,"second_character":"g"},{"first_character":"o","occurrence_count":171,"second_character":"h"},{"first_character":"o","occurrence_count":69,"second_character":"i"},{"first_character":"o","occurrence_count":16,"second_character":"j"},{"first_character":"o","occurrence_count":68,"second_character":"k"},{"first_character":"o","occurrence_count":619,"second_character":"l"},{"first_character":"o","occurrence_count":261,"second_character":"m"},{"first_character":"o","occurrence_count":2411,"second_character":"n"},{"first_character":"o","occurrence_count":115,"second_character":"o"},{"first_character":"o","occurrence_count":95,"second_character":"p"},{"first_character":"o","occurrence_count":3,"second_character":"q"},{"first_character":"o","occurrence_count":1059,"second_character":"r"},{"first_character":"o","occurrence_count":504,"second_character":"s"},{"first_character":"o","occurrence_count":118,"second_character":"t"},{"first_character":"o","occurrence_count":275,"second_character":"u"},{"first_character":"o","occurrence_count":176,"second_character":"v"},{"first_character":"o","occurrence_count":114,"second_character":"w"},{"first_character":"o","occurrence_count":45,"second_character":"x"},{"first_character":"o","occurrence_count":103,"second_character":"y"},{"first_character":"o","occurrence_count":54,"second_character":"z"},{"first_character":"p","occurrence_count":33,"second_character":"."},{"first_character":"p","occurrence_count":209,"second_character":"a"},{"first_character":"p","occurrence_count":2,"second_character":"b"},{"first_character":"p","occurrence_count":1,"second_character":"c"},{"first_character":"p","occurrence_count":0,"second_character":"d"},{"first_character":"p","occurrence_count":197,"second_character":"e"},{"first_character":"p","occurrence_count":1,"second_character":"f"},{"first_character":"p","occurrence_count":0,"second_character":"g"},{"first_character":"p","occurrence_count":204,"second_character":"h"},{"first_character":"p","occurrence_count":61,"second_character":"i"},{"first_character":"p","occurrence_count":1,"second_character":"j"},{"first_character":"p","occurrence_count":1,"second_character":"k"},{"first_character":"p","occurrence_count":16,"second_character":"l"},{"first_character":"p","occurrence_count":1,"second_character":"m"},{"first_character":"p","occurrence_count":1,"second_character":"n"},{"first_character":"p","occurrence_count":59,"second_character":"o"},{"first_character":"p","occurrence_count":39,"second_character":"p"},{"first_character":"p","occurrence_count":0,"second_character":"q"},{"first_character":"p","occurrence_count":151,"second_character":"r"},{"first_character":"p","occurrence_count":16,"second_character":"s"},{"first_character":"p","occurrence_count":17,"second_character":"t"},{"first_character":"p","occurrence_count":4,"second_character":"u"},{"first_character":"p","occurrence_count":0,"second_character":"v"},{"first_character":"p","occurrence_count":0,"second_character":"w"},{"first_character":"p","occurrence_count":0,"second_character":"x"},{"first_character":"p","occurrence_count":12,"second_character":"y"},{"first_character":"p","occurrence_count":0,"second_character":"z"},{"first_character":"q","occurrence_count":28,"second_character":"."},{"first_character":"q","occurrence_count":13,"second_character":"a"},{"first_character":"q","occurrence_count":0,"second_character":"b"},{"first_character":"q","occurrence_count":0,"second_character":"c"},{"first_character":"q","occurrence_count":0,"second_character":"d"},{"first_character":"q","occurrence_count":1,"second_character":"e"},{"first_character":"q","occurrence_count":0,"second_character":"f"},{"first_character":"q","occurrence_count":0,"second_character":"g"},{"first_character":"q","occurrence_count":0,"second_character":"h"},{"first_character":"q","occurrence_count":13,"second_character":"i"},{"first_character":"q","occurrence_count":0,"second_character":"j"},{"first_character":"q","occurrence_count":0,"second_character":"k"},{"first_character":"q","occurrence_count":1,"second_character":"l"},{"first_character":"q","occurrence_count":2,"second_character":"m"},{"first_character":"q","occurrence_count":0,"second_character":"n"},{"first_character":"q","occurrence_count":2,"second_character":"o"},{"first_character":"q","occurrence_count":0,"second_character":"p"},{"first_character":"q","occurrence_count":0,"second_character":"q"},{"first_character":"q","occurrence_count":1,"second_character":"r"},{"first_character":"q","occurrence_count":2,"second_character":"s"},{"first_character":"q","occurrence_count":0,"second_character":"t"},{"first_character":"q","occurrence_count":206,"second_character":"u"},{"first_character":"q","occurrence_count":0,"second_character":"v"},{"first_character":"q","occurrence_count":3,"second_character":"w"},{"first_character":"q","occurrence_count":0,"second_character":"x"},{"first_character":"q","occurrence_count":0,"second_character":"y"},{"first_character":"q","occurrence_count":0,"second_character":"z"},{"first_character":"r","occurrence_count":1377,"second_character":"."},{"first_character":"r","occurrence_count":2356,"second_character":"a"},{"first_character":"r","occurrence_count":41,"second_character":"b"},{"first_character":"r","occurrence_count":99,"second_character":"c"},{"first_character":"r","occurrence_count":187,"second_character":"d"},{"first_character":"r","occurrence_count":1697,"second_character":"e"},{"first_character":"r","occurrence_count":9,"second_character":"f"},{"first_character":"r","occurrence_count":76,"second_character":"g"},{"first_character":"r","occurrence_count":121,"second_character":"h"},{"first_character":"r","occurrence_count":3033,"second_character":"i"},{"first_character":"r","occurrence_count":25,"second_character":"j"},{"first_character":"r","occurrence_count":90,"second_character":"k"},{"first_character":"r","occurrence_count":413,"second_character":"l"},{"first_character":"r","occurrence_count":162,"second_character":"m"},{"first_character":"r","occurrence_count":140,"second_character":"n"},{"first_character":"r","occurrence_count":869,"second_character":"o"},{"first_character":"r","occurrence_count":14,"second_character":"p"},{"first_character":"r","occurrence_count":16,"second_character":"q"},{"first_character":"r","occurrence_count":425,"second_character":"r"},{"first_character":"r","occurrence_count":190,"second_character":"s"},{"first_character":"r","occurrence_count":208,"second_character":"t"},{"first_character":"r","occurrence_count":252,"second_character":"u"},{"first_character":"r","occurrence_count":80,"second_character":"v"},{"first_character":"r","occurrence_count":21,"second_character":"w"},{"first_character":"r","occurrence_count":3,"second_character":"x"},{"first_character":"r","occurrence_count":773,"second_character":"y"},{"first_character":"r","occurrence_count":23,"second_character":"z"},{"first_character":"s","occurrence_count":1169,"second_character":"."},{"first_character":"s","occurrence_count":1201,"second_character":"a"},{"first_character":"s","occurrence_count":21,"second_character":"b"},{"first_character":"s","occurrence_count":60,"second_character":"c"},{"first_character":"s","occurrence_count":9,"second_character":"d"},{"first_character":"s","occurrence_count":884,"second_character":"e"},{"first_character":"s","occurrence_count":2,"second_character":"f"},{"first_character":"s","occurrence_count":2,"second_character":"g"},{"first_character":"s","occurrence_count":1285,"second_character":"h"},{"first_character":"s","occurrence_count":684,"second_character":"i"},{"first_character":"s","occurrence_count":2,"second_character":"j"},{"first_character":"s","occurrence_count":82,"second_character":"k"},{"first_character":"s","occurrence_count":279,"second_character":"l"},{"first_character":"s","occurrence_count":90,"second_character":"m"},{"first_character":"s","occurrence_count":24,"second_character":"n"},{"first_character":"s","occurrence_count":531,"second_character":"o"},{"first_character":"s","occurrence_count":51,"second_character":"p"},{"first_character":"s","occurrence_count":1,"second_character":"q"},{"first_character":"s","occurrence_count":55,"second_character":"r"},{"first_character":"s","occurrence_count":461,"second_character":"s"},{"first_character":"s","occurrence_count":765,"second_character":"t"},{"first_character":"s","occurrence_count":185,"second_character":"u"},{"first_character":"s","occurrence_count":14,"second_character":"v"},{"first_character":"s","occurrence_count":24,"second_character":"w"},{"first_character":"s","occurrence_count":0,"second_character":"x"},{"first_character":"s","occurrence_count":215,"second_character":"y"},{"first_character":"s","occurrence_count":10,"second_character":"z"},{"first_character":"t","occurrence_count":483,"second_character":"."},{"first_character":"t","occurrence_count":1027,"second_character":"a"},{"first_character":"t","occurrence_count":1,"second_character":"b"},{"first_character":"t","occurrence_count":17,"second_character":"c"},{"first_character":"t","occurrence_count":0,"second_character":"d"},{"first_character":"t","occurrence_count":716,"second_character":"e"},{"first_character":"t","occurrence_count":2,"second_character":"f"},{"first_character":"t","occurrence_count":2,"second_character":"g"},{"first_character":"t","occurrence_count":647,"second_character":"h"},{"first_character":"t","occurrence_count":532,"second_character":"i"},{"first_character":"t","occurrence_count":3,"second_character":"j"},{"first_character":"t","occurrence_count":0,"second_character":"k"},{"first_character":"t","occurrence_count":134,"second_character":"l"},{"first_character":"t","occurrence_count":4,"second_character":"m"},{"first_character":"t","occurrence_count":22,"second_character":"n"},{"first_character":"t","occurrence_count":667,"second_character":"o"},{"first_character":"t","occurrence_count":0,"second_character":"p"},{"first_character":"t","occurrence_count":0,"second_character":"q"},{"first_character":"t","occurrence_count":352,"second_character":"r"},{"first_character":"t","occurrence_count":35,"second_character":"s"},{"first_character":"t","occurrence_count":374,"second_character":"t"},{"first_character":"t","occurrence_count":78,"second_character":"u"},{"first_character":"t","occurrence_count":15,"second_character":"v"},{"first_character":"t","occurrence_count":11,"second_character":"w"},{"first_character":"t","occurrence_count":2,"second_character":"x"},{"first_character":"t","occurrence_count":341,"second_character":"y"},{"first_character":"t","occurrence_count":105,"second_character":"z"},{"first_character":"u","occurrence_count":155,"second_character":"."},{"first_character":"u","occurrence_count":163,"second_character":"a"},{"first_character":"u","occurrence_count":103,"second_character":"b"},{"first_character":"u","occurrence_count":103,"second_character":"c"},{"first_character":"u","occurrence_count":136,"second_character":"d"},{"first_character":"u","occurrence_count":169,"second_character":"e"},{"first_character":"u","occurrence_count":19,"second_character":"f"},{"first_character":"u","occurrence_count":47,"second_character":"g"},{"first_character":"u","occurrence_count":58,"second_character":"h"},{"first_character":"u","occurrence_count":121,"second_character":"i"},{"first_character":"u","occurrence_count":14,"second_character":"j"},{"first_character":"u","occurrence_count":93,"second_character":"k"},{"first_character":"u","occurrence_count":301,"second_character":"l"},{"first_character":"u","occurrence_count":154,"second_character":"m"},{"first_character":"u","occurrence_count":275,"second_character":"n"},{"first_character":"u","occurrence_count":10,"second_character":"o"},{"first_character":"u","occurrence_count":16,"second_character":"p"},{"first_character":"u","occurrence_count":10,"second_character":"q"},{"first_character":"u","occurrence_count":414,"second_character":"r"},{"first_character":"u","occurrence_count":474,"second_character":"s"},{"first_character":"u","occurrence_count":82,"second_character":"t"},{"first_character":"u","occurrence_count":3,"second_character":"u"},{"first_character":"u","occurrence_count":37,"second_character":"v"},{"first_character":"u","occurrence_count":86,"second_character":"w"},{"first_character":"u","occurrence_count":34,"second_character":"x"},{"first_character":"u","occurrence_count":13,"second_character":"y"},{"first_character":"u","occurrence_count":45,"second_character":"z"},{"first_character":"v","occurrence_count":88,"second_character":"."},{"first_character":"v","occurrence_count":642,"second_character":"a"},{"first_character":"v","occurrence_count":1,"second_character":"b"},{"first_character":"v","occurrence_count":0,"second_character":"c"},{"first_character":"v","occurrence_count":1,"second_character":"d"},{"first_character":"v","occurrence_count":568,"second_character":"e"},{"first_character":"v","occurrence_count":0,"second_character":"f"},{"first_character":"v","occurrence_count":0,"second_character":"g"},{"first_character":"v","occurrence_count":1,"second_character":"h"},{"first_character":"v","occurrence_count":911,"second_character":"i"},{"first_character":"v","occurrence_count":0,"second_character":"j"},{"first_character":"v","occurrence_count":3,"second_character":"k"},{"first_character":"v","occurrence_count":14,"second_character":"l"},{"first_character":"v","occurrence_count":0,"second_character":"m"},{"first_character":"v","occurrence_count":8,"second_character":"n"},{"first_character":"v","occurrence_count":153,"second_character":"o"},{"first_character":"v","occurrence_count":0,"second_character":"p"},{"first_character":"v","occurrence_count":0,"second_character":"q"},{"first_character":"v","occurrence_count":48,"second_character":"r"},{"first_character":"v","occurrence_count":0,"second_character":"s"},{"first_character":"v","occurrence_count":0,"second_character":"t"},{"first_character":"v","occurrence_count":7,"second_character":"u"},{"first_character":"v","occurrence_count":7,"second_character":"v"},{"first_character":"v","occurrence_count":0,"second_character":"w"},{"first_character":"v","occurrence_count":0,"second_character":"x"},{"first_character":"v","occurrence_count":121,"second_character":"y"},{"first_character":"v","occurrence_count":0,"second_character":"z"},{"first_character":"w","occurrence_count":51,"second_character":"."},{"first_character":"w","occurrence_count":280,"second_character":"a"},{"first_character":"w","occurrence_count":1,"second_character":"b"},{"first_character":"w","occurrence_count":0,"second_character":"c"},{"first_character":"w","occurrence_count":8,"second_character":"d"},{"first_character":"w","occurrence_count":149,"second_character":"e"},{"first_character":"w","occurrence_count":2,"second_character":"f"},{"first_character":"w","occurrence_count":1,"second_character":"g"},{"first_character":"w","occurrence_count":23,"second_character":"h"},{"first_character":"w","occurrence_count":148,"second_character":"i"},{"first_character":"w","occurrence_count":0,"second_character":"j"},{"first_character":"w","occurrence_count":6,"second_character":"k"},{"first_character":"w","occurrence_count":13,"second_character":"l"},{"first_character":"w","occurrence_count":2,"second_character":"m"},{"first_character":"w","occurrence_count":58,"second_character":"n"},{"first_character":"w","occurrence_count":36,"second_character":"o"},{"first_character":"w","occurrence_count":0,"second_character":"p"},{"first_character":"w","occurrence_count":0,"second_character":"q"},{"first_character":"w","occurrence_count":22,"second_character":"r"},{"first_character":"w","occurrence_count":20,"second_character":"s"},{"first_character":"w","occurrence_count":8,"second_character":"t"},{"first_character":"w","occurrence_count":25,"second_character":"u"},{"first_character":"w","occurrence_count":0,"second_character":"v"},{"first_character":"w","occurrence_count":2,"second_character":"w"},{"first_character":"w","occurrence_count":0,"second_character":"x"},{"first_character":"w","occurrence_count":73,"second_character":"y"},{"first_character":"w","occurrence_count":1,"second_character":"z"},{"first_character":"x","occurrence_count":164,"second_character":"."},{"first_character":"x","occurrence_count":103,"second_character":"a"},{"first_character":"x","occurrence_count":1,"second_character":"b"},{"first_character":"x","occurrence_count":4,"second_character":"c"},{"first_character":"x","occurrence_count":5,"second_character":"d"},{"first_character":"x","occurrence_count":36,"second_character":"e"},{"first_character":"x","occurrence_count":3,"second_character":"f"},{"first_character":"x","occurrence_count":0,"second_character":"g"},{"first_character":"x","occurrence_count":1,"second_character":"h"},{"first_character":"x","occurrence_count":102,"second_character":"i"},{"first_character":"x","occurrence_count":0,"second_character":"j"},{"first_character":"x","occurrence_count":0,"second_character":"k"},{"first_character":"x","occurrence_count":39,"second_character":"l"},{"first_character":"x","occurrence_count":1,"second_character":"m"},{"first_character":"x","occurrence_count":1,"second_character":"n"},{"first_character":"x","occurrence_count":41,"second_character":"o"},{"first_character":"x","occurrence_count":0,"second_character":"p"},{"first_character":"x","occurrence_count":0,"second_character":"q"},{"first_character":"x","occurrence_count":0,"second_character":"r"},{"first_character":"x","occurrence_count":31,"second_character":"s"},{"first_character":"x","occurrence_count":70,"second_character":"t"},{"first_character":"x","occurrence_count":5,"second_character":"u"},{"first_character":"x","occurrence_count":0,"second_character":"v"},{"first_character":"x","occurrence_count":3,"second_character":"w"},{"first_character":"x","occurrence_count":38,"second_character":"x"},{"first_character":"x","occurrence_count":30,"second_character":"y"},{"first_character":"x","occurrence_count":19,"second_character":"z"},{"first_character":"y","occurrence_count":2007,"second_character":"."},{"first_character":"y","occurrence_count":2143,"second_character":"a"},{"first_character":"y","occurrence_count":27,"second_character":"b"},{"first_character":"y","occurrence_count":115,"second_character":"c"},{"first_character":"y","occurrence_count":272,"second_character":"d"},{"first_character":"y","occurrence_count":301,"second_character":"e"},{"first_character":"y","occurrence_count":12,"second_character":"f"},{"first_character":"y","occurrence_count":30,"second_character":"g"},{"first_character":"y","occurrence_count":22,"second_character":"h"},{"first_character":"y","occurrence_count":192,"second_character":"i"},{"first_character":"y","occurrence_count":23,"second_character":"j"},{"first_character":"y","occurrence_count":86,"second_character":"k"},{"first_character":"y","occurrence_count":1104,"second_character":"l"},{"first_character":"y","occurrence_count":148,"second_character":"m"},{"first_character":"y","occurrence_count":1826,"second_character":"n"},{"first_character":"y","occurrence_count":271,"second_character":"o"},{"first_character":"y","occurrence_count":15,"second_character":"p"},{"first_character":"y","occurrence_count":6,"second_character":"q"},{"first_character":"y","occurrence_count":291,"second_character":"r"},{"first_character":"y","occurrence_count":401,"second_character":"s"},{"first_character":"y","occurrence_count":104,"second_character":"t"},{"first_character":"y","occurrence_count":141,"second_character":"u"},{"first_character":"y","occurrence_count":106,"second_character":"v"},{"first_character":"y","occurrence_count":4,"second_character":"w"},{"first_character":"y","occurrence_count":28,"second_character":"x"},{"first_character":"y","occurrence_count":23,"second_character":"y"},{"first_character":"y","occurrence_count":78,"second_character":"z"},{"first_character":"z","occurrence_count":160,"second_character":"."},{"first_character":"z","occurrence_count":860,"second_character":"a"},{"first_character":"z","occurrence_count":4,"second_character":"b"},{"first_character":"z","occurrence_count":2,"second_character":"c"},{"first_character":"z","occurrence_count":2,"second_character":"d"},{"first_character":"z","occurrence_count":373,"second_character":"e"},{"first_character":"z","occurrence_count":0,"second_character":"f"},{"first_character":"z","occurrence_count":1,"second_character":"g"},{"first_character":"z","occurrence_count":43,"second_character":"h"},{"first_character":"z","occurrence_count":364,"second_character":"i"},{"first_character":"z","occurrence_count":2,"second_character":"j"},{"first_character":"z","occurrence_count":2,"second_character":"k"},{"first_character":"z","occurrence_count":123,"second_character":"l"},{"first_character":"z","occurrence_count":35,"second_character":"m"},{"first_character":"z","occurrence_count":4,"second_character":"n"},{"first_character":"z","occurrence_count":110,"second_character":"o"},{"first_character":"z","occurrence_count":2,"second_character":"p"},{"first_character":"z","occurrence_count":0,"second_character":"q"},{"first_character":"z","occurrence_count":32,"second_character":"r"},{"first_character":"z","occurrence_count":4,"second_character":"s"},{"first_character":"z","occurrence_count":4,"second_character":"t"},{"first_character":"z","occurrence_count":73,"second_character":"u"},{"first_character":"z","occurrence_count":2,"second_character":"v"},{"first_character":"z","occurrence_count":3,"second_character":"w"},{"first_character":"z","occurrence_count":1,"second_character":"x"},{"first_character":"z","occurrence_count":147,"second_character":"y"},{"first_character":"z","occurrence_count":45,"second_character":"z"}]},"layer":[{"encoding":{"color":{"aggregate":"sum","field":"occurrence_count","legend":false,"type":"quantitative"},"x":{"axis":{"labelAngle":0,"orient":"top"},"field":"second_character","type":"nominal"},"y":{"field":"first_character","type":"nominal"}},"mark":{"fillOpacity":1,"tooltip":true,"type":"rect"}},{"encoding":{"text":{"aggregate":"sum","field":"occurrence_count","type":"quantitative"},"x":{"axis":{"labelAngle":0,"orient":"top"},"field":"second_character","type":"nominal"},"y":{"field":"first_character","type":"nominal"}},"mark":"text"}],"width":800}
```

## Nx Tensor

```elixir
# Use the XLA backend for Nx so that computations are done more efficiently
# using Google's Accelerated Linear Algebra library.
Nx.global_default_backend(EXLA.Backend)
```

<!-- livebook:{"output":true} -->

```
{Nx.BinaryBackend, []}
```

To start being efficient with the models we create we can leverage the nurmerical Elixir library `Nx` ([docs](https://hexdocs.pm/nx/Nx.html)).

We can create a 2-dimensional tensor to store the count of the bigrams.

```elixir
vocabulary = Enum.concat([?.], ?a..?z)
vocabulary_size = length(vocabulary)

bigram_matrix =
  List.duplicate(0, vocabulary_size * vocabulary_size)
  |> Nx.tensor(type: :u32)
  |> Nx.reshape({vocabulary_size, vocabulary_size})
```

<!-- livebook:{"output":true} -->

```
#Nx.Tensor<
  u32[27][27]
  EXLA.Backend<host:0, 0.293816628.2104098832.256211>
  [
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...],
    ...
  ]
>
```

```elixir
defmodule BigramMapping do
  def str_to_int("."), do: 0
  def str_to_int(char), do: hd(to_charlist(char)) - ?a + 1

  def int_to_str(0), do: "."
  def int_to_str(int), do: to_string([int + ?a - 1])

  def encode(chars), do: Enum.map(chars, &str_to_int/1)
  def decode(chars), do: Enum.map(chars, &int_to_str/1)
end
```

<!-- livebook:{"output":true} -->

```
{:module, BigramMapping, <<70, 79, 82, 49, 0, 0, 11, ...>>, {:decode, 1}}
```

```elixir
bigram_matrix =
  Enum.reduce(bigram_count, bigram_matrix, fn {bigram, count}, tensor ->
    t_index = Nx.tensor(BigramMapping.encode(bigram))
    Nx.indexed_add(tensor, t_index, count)
  end)
```

<!-- livebook:{"output":true} -->

```
#Nx.Tensor<
  s64[27][27]
  EXLA.Backend<host:0, 0.293816628.2104098832.258096>
  [
    [0, 4410, 1306, 1542, 1690, 1531, 417, 669, 874, 591, 2422, 2963, 1572, 2538, 1146, 394, 515, 92, 1639, 2055, 1308, 78, 376, 307, 134, 535, 929],
    [6640, 556, 541, 470, 1042, 692, 134, 168, 2332, 1650, 175, 568, 2528, 1634, 5438, 63, 82, 60, 3264, 1118, 687, 381, 834, ...],
    ...
  ]
>
```

## Simple probability model

We can take this bigram matrix and create a probability matrix telling us the liklihood of each character following the given character. For that we just need to divide each count in the matrix by the sum of the row.

```elixir
bigram_matrix_probabilites =
  Nx.divide(
    bigram_matrix,
    Nx.sum(bigram_matrix, axes: [1], keep_axes: true)
  )
```

<!-- livebook:{"output":true} -->

```
#Nx.Tensor<
  f32[27][27]
  EXLA.Backend<host:0, 0.293816628.2104098832.258100>
  [
    [0.0, 0.13767053186893463, 0.040770456194877625, 0.048137858510017395, 0.05275809392333031, 0.047794461250305176, 0.013017825782299042, 0.020884713158011436, 0.02728436328470707, 0.018449723720550537, 0.07560952752828598, 0.09249836206436157, 0.04907439276576042, 0.07923079282045364, 0.03577560558915138, 0.012299816124141216, 0.01607717014849186, 0.0028720381669700146, 0.05116598680615425, 0.06415259093046188, 0.040832892060279846, 0.002434988971799612, 0.01173789519816637, 0.009583866223692894, 0.0041831862181425095, 0.016701526939868927, 0.02900134213268757],
    [0.19595691561698914, 0.016408439725637436, 0.015965767204761505, 0.013870444148778915, 0.030751070007681847, 0.020422015339136124, 0.003954552114009857, 0.004957946017384529, 0.0688210129737854, 0.04869411140680313, 0.005164526868611574, 0.01676257885992527, 0.07460528612136841, 0.048221927136182785, 0.16048398613929749, 0.0018592297565191984, 0.0024199497420340776, 0.0017706949729472399, 0.09632580727338791, 0.032993949949741364, 0.020274458453059196, 0.011243913322687149, 0.024612659588456154, ...],
    ...
  ]
>
```

```elixir
for x <- 0..(vocabulary_size - 1), y <- 0..(vocabulary_size - 1) do
  %{
    "first_character" => BigramMapping.int_to_str(x),
    "second_character" => BigramMapping.int_to_str(y),
    "occurrence_count" =>
      (Nx.to_number(bigram_matrix_probabilites[x][y]) * 100)
      |> Float.round(2)
  }
end
|> Tucan.heatmap(
  "second_character",
  "first_character",
  "occurrence_count",
  annotate: true,
  tooltip: true,
  color: [legend: false],
  x: [axis: [orient: :top, label_angle: 0]]
)
|> Tucan.set_theme(:power_bi)
|> Tucan.set_width(850)
```

<!-- livebook:{"output":true} -->

```vega-lite
{"$schema":"https://vega.github.io/schema/vega-lite/v5.json","__tucan__":{"multilayer":true,"types":{"first_character":"nominal","occurrence_count":"quantitative","second_character":"nominal"}},"config":{"arc":{"fill":"#118DFF"},"area":{"fill":"#118DFF","line":true,"opacity":0.6},"axis":{"domain":false,"grid":false,"labelColor":"#605E5C","labelFontSize":12.0,"ticks":false,"titleColor":"#252423","titleFont":"wf_standard-font, helvetica, arial, sans-serif","titleFontSize":16.0,"titleFontWeight":"normal"},"axisBand":{"tickExtra":true},"axisQuantitative":{"grid":true,"gridColor":"#c8C6C4","gridDash":[1,5],"labelFlush":false,"tickCount":3},"axisX":{"labelPadding":5},"axisY":{"labelPadding":10},"background":"transparent","bar":{"fill":"#118DFF"},"font":"segoe uI","header":{"labelColor":"#605E5C","labelFont":"segoe uI","labelFontSize":13.333333333333332,"titleColor":"#252423","titleFont":"wf_standard-font, helvetica, arial, sans-serif","titleFontSize":16.0},"legend":{"labelColor":"#605E5C","labelFont":"segoe uI","labelFontSize":13.333333333333332,"symbolSize":75,"symbolType":"circle","titleColor":"#605E5C","titleFont":"segoe uI","titleFontWeight":"bold"},"line":{"stroke":"#118DFF","strokeCap":"round","strokeJoin":"round","strokeWidth":3},"path":{"stroke":"#118DFF"},"point":{"fill":"#118DFF","filled":true,"size":75},"range":{"category":["#118DFF","#12239E","#e66C37","#6B007B","#e044A7","#744EC2","#d9B300","#d64550"],"diverging":["#dEEFFF","#118DFF"],"heatmap":["#dEEFFF","#118DFF"],"ordinal":["#dEEFFF","#c7e4ff","#b0d9ff","#9aceff","#83c3ff","#6cb9ff","#55aeff","#3fa3ff","#2898ff","#118DFF"]},"rect":{"fill":"#118DFF"},"shape":{"stroke":"#118DFF"},"symbol":{"fill":"#118DFF","size":50,"strokeWidth":1.5},"text":{"fill":"#605E5C","font":"segoe uI","fontSize":12.0},"view":{"stroke":"transparent"}},"data":{"values":[{"first_character":".","occurrence_count":0.0,"second_character":"."},{"first_character":".","occurrence_count":13.77,"second_character":"a"},{"first_character":".","occurrence_count":4.08,"second_character":"b"},{"first_character":".","occurrence_count":4.81,"second_character":"c"},{"first_character":".","occurrence_count":5.28,"second_character":"d"},{"first_character":".","occurrence_count":4.78,"second_character":"e"},{"first_character":".","occurrence_count":1.3,"second_character":"f"},{"first_character":".","occurrence_count":2.09,"second_character":"g"},{"first_character":".","occurrence_count":2.73,"second_character":"h"},{"first_character":".","occurrence_count":1.84,"second_character":"i"},{"first_character":".","occurrence_count":7.56,"second_character":"j"},{"first_character":".","occurrence_count":9.25,"second_character":"k"},{"first_character":".","occurrence_count":4.91,"second_character":"l"},{"first_character":".","occurrence_count":7.92,"second_character":"m"},{"first_character":".","occurrence_count":3.58,"second_character":"n"},{"first_character":".","occurrence_count":1.23,"second_character":"o"},{"first_character":".","occurrence_count":1.61,"second_character":"p"},{"first_character":".","occurrence_count":0.29,"second_character":"q"},{"first_character":".","occurrence_count":5.12,"second_character":"r"},{"first_character":".","occurrence_count":6.42,"second_character":"s"},{"first_character":".","occurrence_count":4.08,"second_character":"t"},{"first_character":".","occurrence_count":0.24,"second_character":"u"},{"first_character":".","occurrence_count":1.17,"second_character":"v"},{"first_character":".","occurrence_count":0.96,"second_character":"w"},{"first_character":".","occurrence_count":0.42,"second_character":"x"},{"first_character":".","occurrence_count":1.67,"second_character":"y"},{"first_character":".","occurrence_count":2.9,"second_character":"z"},{"first_character":"a","occurrence_count":19.6,"second_character":"."},{"first_character":"a","occurrence_count":1.64,"second_character":"a"},{"first_character":"a","occurrence_count":1.6,"second_character":"b"},{"first_character":"a","occurrence_count":1.39,"second_character":"c"},{"first_character":"a","occurrence_count":3.08,"second_character":"d"},{"first_character":"a","occurrence_count":2.04,"second_character":"e"},{"first_character":"a","occurrence_count":0.4,"second_character":"f"},{"first_character":"a","occurrence_count":0.5,"second_character":"g"},{"first_character":"a","occurrence_count":6.88,"second_character":"h"},{"first_character":"a","occurrence_count":4.87,"second_character":"i"},{"first_character":"a","occurrence_count":0.52,"second_character":"j"},{"first_character":"a","occurrence_count":1.68,"second_character":"k"},{"first_character":"a","occurrence_count":7.46,"second_character":"l"},{"first_character":"a","occurrence_count":4.82,"second_character":"m"},{"first_character":"a","occurrence_count":16.05,"second_character":"n"},{"first_character":"a","occurrence_count":0.19,"second_character":"o"},{"first_character":"a","occurrence_count":0.24,"second_character":"p"},{"first_character":"a","occurrence_count":0.18,"second_character":"q"},{"first_character":"a","occurrence_count":9.63,"second_character":"r"},{"first_character":"a","occurrence_count":3.3,"second_character":"s"},{"first_character":"a","occurrence_count":2.03,"second_character":"t"},{"first_character":"a","occurrence_count":1.12,"second_character":"u"},{"first_character":"a","occurrence_count":2.46,"second_character":"v"},{"first_character":"a","occurrence_count":0.48,"second_character":"w"},{"first_character":"a","occurrence_count":0.54,"second_character":"x"},{"first_character":"a","occurrence_count":6.05,"second_character":"y"},{"first_character":"a","occurrence_count":1.28,"second_character":"z"},{"first_character":"b","occurrence_count":4.31,"second_character":"."},{"first_character":"b","occurrence_count":12.14,"second_character":"a"},{"first_character":"b","occurrence_count":1.44,"second_character":"b"},{"first_character":"b","occurrence_count":0.04,"second_character":"c"},{"first_character":"b","occurrence_count":2.46,"second_character":"d"},{"first_character":"b","occurrence_count":24.76,"second_character":"e"},{"first_character":"b","occurrence_count":0.0,"second_character":"f"},{"first_character":"b","occurrence_count":0.0,"second_character":"g"},{"first_character":"b","occurrence_count":1.55,"second_character":"h"},{"first_character":"b","occurrence_count":8.2,"second_character":"i"},{"first_character":"b","occurrence_count":0.04,"second_character":"j"},{"first_character":"b","occurrence_count":0.0,"second_character":"k"},{"first_character":"b","occurrence_count":3.89,"second_character":"l"},{"first_character":"b","occurrence_count":0.0,"second_character":"m"},{"first_character":"b","occurrence_count":0.15,"second_character":"n"},{"first_character":"b","occurrence_count":3.97,"second_character":"o"},{"first_character":"b","occurrence_count":0.0,"second_character":"p"},{"first_character":"b","occurrence_count":0.0,"second_character":"q"},{"first_character":"b","occurrence_count":31.83,"second_character":"r"},{"first_character":"b","occurrence_count":0.3,"second_character":"s"},{"first_character":"b","occurrence_count":0.08,"second_character":"t"},{"first_character":"b","occurrence_count":1.7,"second_character":"u"},{"first_character":"b","occurrence_count":0.0,"second_character":"v"},{"first_character":"b","occurrence_count":0.0,"second_character":"w"},{"first_character":"b","occurrence_count":0.0,"second_character":"x"},{"first_character":"b","occurrence_count":3.14,"second_character":"y"},{"first_character":"b","occurrence_count":0.0,"second_character":"z"},{"first_character":"c","occurrence_count":2.75,"second_character":"."},{"first_character":"c","occurrence_count":23.07,"second_character":"a"},{"first_character":"c","occurrence_count":0.0,"second_character":"b"},{"first_character":"c","occurrence_count":1.19,"second_character":"c"},{"first_character":"c","occurrence_count":0.03,"second_character":"d"},{"first_character":"c","occurrence_count":15.6,"second_character":"e"},{"first_character":"c","occurrence_count":0.0,"second_character":"f"},{"first_character":"c","occurrence_count":0.06,"second_character":"g"},{"first_character":"c","occurrence_count":18.8,"second_character":"h"},{"first_character":"c","occurrence_count":7.67,"second_character":"i"},{"first_character":"c","occurrence_count":0.08,"second_character":"j"},{"first_character":"c","occurrence_count":8.95,"second_character":"k"},{"first_character":"c","occurrence_count":3.28,"second_character":"l"},{"first_character":"c","occurrence_count":0.0,"second_character":"m"},{"first_character":"c","occurrence_count":0.0,"second_character":"n"},{"first_character":"c","occurrence_count":10.76,"second_character":"o"},{"first_character":"c","occurrence_count":0.03,"second_character":"p"},{"first_character":"c","occurrence_count":0.31,"second_character":"q"},{"first_character":"c","occurrence_count":2.15,"second_character":"r"},{"first_character":"c","occurrence_count":0.14,"second_character":"s"},{"first_character":"c","occurrence_count":0.99,"second_character":"t"},{"first_character":"c","occurrence_count":0.99,"second_character":"u"},{"first_character":"c","occurrence_count":0.0,"second_character":"v"},{"first_character":"c","occurrence_count":0.0,"second_character":"w"},{"first_character":"c","occurrence_count":0.08,"second_character":"x"},{"first_character":"c","occurrence_count":2.94,"second_character":"y"},{"first_character":"c","occurrence_count":0.11,"second_character":"z"},{"first_character":"d","occurrence_count":9.39,"second_character":"."},{"first_character":"d","occurrence_count":23.71,"second_character":"a"},{"first_character":"d","occurrence_count":0.02,"second_character":"b"},{"first_character":"d","occurrence_count":0.05,"second_character":"c"},{"first_character":"d","occurrence_count":2.71,"second_character":"d"},{"first_character":"d","occurrence_count":23.34,"second_character":"e"},{"first_character":"d","occurrence_count":0.09,"second_character":"f"},{"first_character":"d","occurrence_count":0.45,"second_character":"g"},{"first_character":"d","occurrence_count":2.15,"second_character":"h"},{"first_character":"d","occurrence_count":12.26,"second_character":"i"},{"first_character":"d","occurrence_count":0.16,"second_character":"j"},{"first_character":"d","occurrence_count":0.05,"second_character":"k"},{"first_character":"d","occurrence_count":1.09,"second_character":"l"},{"first_character":"d","occurrence_count":0.55,"second_character":"m"},{"first_character":"d","occurrence_count":0.56,"second_character":"n"},{"first_character":"d","occurrence_count":6.88,"second_character":"o"},{"first_character":"d","occurrence_count":0.0,"second_character":"p"},{"first_character":"d","occurrence_count":0.02,"second_character":"q"},{"first_character":"d","occurrence_count":7.71,"second_character":"r"},{"first_character":"d","occurrence_count":0.53,"second_character":"s"},{"first_character":"d","occurrence_count":0.07,"second_character":"t"},{"first_character":"d","occurrence_count":1.67,"second_character":"u"},{"first_character":"d","occurrence_count":0.31,"second_character":"v"},{"first_character":"d","occurrence_count":0.42,"second_character":"w"},{"first_character":"d","occurrence_count":0.0,"second_character":"x"},{"first_character":"d","occurrence_count":5.77,"second_character":"y"},{"first_character":"d","occurrence_count":0.02,"second_character":"z"},{"first_character":"e","occurrence_count":19.5,"second_character":"."},{"first_character":"e","occurrence_count":3.32,"second_character":"a"},{"first_character":"e","occurrence_count":0.59,"second_character":"b"},{"first_character":"e","occurrence_count":0.75,"second_character":"c"},{"first_character":"e","occurrence_count":1.88,"second_character":"d"},{"first_character":"e","occurrence_count":6.22,"second_character":"e"},{"first_character":"e","occurrence_count":0.4,"second_character":"f"},{"first_character":"e","occurrence_count":0.61,"second_character":"g"},{"first_character":"e","occurrence_count":0.74,"second_character":"h"},{"first_character":"e","occurrence_count":4.01,"second_character":"i"},{"first_character":"e","occurrence_count":0.27,"second_character":"j"},{"first_character":"e","occurrence_count":0.87,"second_character":"k"},{"first_character":"e","occurrence_count":15.9,"second_character":"l"},{"first_character":"e","occurrence_count":3.77,"second_character":"m"},{"first_character":"e","occurrence_count":13.1,"second_character":"n"},{"first_character":"e","occurrence_count":1.32,"second_character":"o"},{"first_character":"e","occurrence_count":0.41,"second_character":"p"},{"first_character":"e","occurrence_count":0.07,"second_character":"q"},{"first_character":"e","occurrence_count":9.59,"second_character":"r"},{"first_character":"e","occurrence_count":4.22,"second_character":"s"},{"first_character":"e","occurrence_count":2.84,"second_character":"t"},{"first_character":"e","occurrence_count":0.34,"second_character":"u"},{"first_character":"e","occurrence_count":2.27,"second_character":"v"},{"first_character":"e","occurrence_count":0.24,"second_character":"w"},{"first_character":"e","occurrence_count":0.65,"second_character":"x"},{"first_character":"e","occurrence_count":5.24,"second_character":"y"},{"first_character":"e","occurrence_count":0.89,"second_character":"z"},{"first_character":"f","occurrence_count":8.84,"second_character":"."},{"first_character":"f","occurrence_count":26.74,"second_character":"a"},{"first_character":"f","occurrence_count":0.0,"second_character":"b"},{"first_character":"f","occurrence_count":0.0,"second_character":"c"},{"first_character":"f","occurrence_count":0.0,"second_character":"d"},{"first_character":"f","occurrence_count":13.59,"second_character":"e"},{"first_character":"f","occurrence_count":4.86,"second_character":"f"},{"first_character":"f","occurrence_count":0.11,"second_character":"g"},{"first_character":"f","occurrence_count":0.11,"second_character":"h"},{"first_character":"f","occurrence_count":17.68,"second_character":"i"},{"first_character":"f","occurrence_count":0.0,"second_character":"j"},{"first_character":"f","occurrence_count":0.22,"second_character":"k"},{"first_character":"f","occurrence_count":2.21,"second_character":"l"},{"first_character":"f","occurrence_count":0.0,"second_character":"m"},{"first_character":"f","occurrence_count":0.44,"second_character":"n"},{"first_character":"f","occurrence_count":6.63,"second_character":"o"},{"first_character":"f","occurrence_count":0.0,"second_character":"p"},{"first_character":"f","occurrence_count":0.0,"second_character":"q"},{"first_character":"f","occurrence_count":12.6,"second_character":"r"},{"first_character":"f","occurrence_count":0.66,"second_character":"s"},{"first_character":"f","occurrence_count":1.99,"second_character":"t"},{"first_character":"f","occurrence_count":1.1,"second_character":"u"},{"first_character":"f","occurrence_count":0.0,"second_character":"v"},{"first_character":"f","occurrence_count":0.44,"second_character":"w"},{"first_character":"f","occurrence_count":0.0,"second_character":"x"},{"first_character":"f","occurrence_count":1.55,"second_character":"y"},{"first_character":"f","occurrence_count":0.22,"second_character":"z"},{"first_character":"g","occurrence_count":5.6,"second_character":"."},{"first_character":"g","occurrence_count":17.13,"second_character":"a"},{"first_character":"g","occurrence_count":0.16,"second_character":"b"},{"first_character":"g","occurrence_count":0.0,"second_character":"c"},{"first_character":"g","occurrence_count":0.99,"second_character":"d"},{"first_character":"g","occurrence_count":17.33,"second_character":"e"},{"first_character":"g","occurrence_count":0.05,"second_character":"f"},{"first_character":"g","occurrence_count":1.3,"second_character":"g"},{"first_character":"g","occurrence_count":18.68,"second_character":"h"},{"first_character":"g","occurrence_count":9.86,"second_character":"i"},{"first_character":"g","occurrence_count":0.16,"second_character":"j"},{"first_character":"g","occurrence_count":0.0,"second_character":"k"},{"first_character":"g","occurrence_count":1.66,"second_character":"l"},{"first_character":"g","occurrence_count":0.31,"second_character":"m"},{"first_character":"g","occurrence_count":1.4,"second_character":"n"},{"first_character":"g","occurrence_count":4.31,"second_character":"o"},{"first_character":"g","occurrence_count":0.0,"second_character":"p"},{"first_character":"g","occurrence_count":0.0,"second_character":"q"},{"first_character":"g","occurrence_count":10.43,"second_character":"r"},{"first_character":"g","occurrence_count":1.56,"second_character":"s"},{"first_character":"g","occurrence_count":1.61,"second_character":"t"},{"first_character":"g","occurrence_count":4.41,"second_character":"u"},{"first_character":"g","occurrence_count":0.05,"second_character":"v"},{"first_character":"g","occurrence_count":1.35,"second_character":"w"},{"first_character":"g","occurrence_count":0.0,"second_character":"x"},{"first_character":"g","occurrence_count":1.61,"second_character":"y"},{"first_character":"g","occurrence_count":0.05,"second_character":"z"},{"first_character":"h","occurrence_count":31.63,"second_character":"."},{"first_character":"h","occurrence_count":29.46,"second_character":"a"},{"first_character":"h","occurrence_count":0.11,"second_character":"b"},{"first_character":"h","occurrence_count":0.03,"second_character":"c"},{"first_character":"h","occurrence_count":0.32,"second_character":"d"},{"first_character":"h","occurrence_count":8.85,"second_character":"e"},{"first_character":"h","occurrence_count":0.03,"second_character":"f"},{"first_character":"h","occurrence_count":0.03,"second_character":"g"},{"first_character":"h","occurrence_count":0.01,"second_character":"h"},{"first_character":"h","occurrence_count":9.57,"second_character":"i"},{"first_character":"h","occurrence_count":0.12,"second_character":"j"},{"first_character":"h","occurrence_count":0.38,"second_character":"k"},{"first_character":"h","occurrence_count":2.43,"second_character":"l"},{"first_character":"h","occurrence_count":1.54,"second_character":"m"},{"first_character":"h","occurrence_count":1.81,"second_character":"n"},{"first_character":"h","occurrence_count":3.77,"second_character":"o"},{"first_character":"h","occurrence_count":0.01,"second_character":"p"},{"first_character":"h","occurrence_count":0.01,"second_character":"q"},{"first_character":"h","occurrence_count":2.68,"second_character":"r"},{"first_character":"h","occurrence_count":0.41,"second_character":"s"},{"first_character":"h","occurrence_count":0.93,"second_character":"t"},{"first_character":"h","occurrence_count":2.18,"second_character":"u"},{"first_character":"h","occurrence_count":0.51,"second_character":"v"},{"first_character":"h","occurrence_count":0.13,"second_character":"w"},{"first_character":"h","occurrence_count":0.0,"second_character":"x"},{"first_character":"h","occurrence_count":2.8,"second_character":"y"},{"first_character":"h","occurrence_count":0.26,"second_character":"z"},{"first_character":"i","occurrence_count":14.06,"second_character":"."},{"first_character":"i","occurrence_count":13.81,"second_character":"a"},{"first_character":"i","occurrence_count":0.62,"second_character":"b"},{"first_character":"i","occurrence_count":2.88,"second_character":"c"},{"first_character":"i","occurrence_count":2.49,"second_character":"d"},{"first_character":"i","occurrence_count":9.34,"second_character":"e"},{"first_character":"i","occurrence_count":0.57,"second_character":"f"},{"first_character":"i","occurrence_count":2.42,"second_character":"g"},{"first_character":"i","occurrence_count":0.54,"second_character":"h"},{"first_character":"i","occurrence_count":0.46,"second_character":"i"},{"first_character":"i","occurrence_count":0.43,"second_character":"j"},{"first_character":"i","occurrence_count":2.51,"second_character":"k"},{"first_character":"i","occurrence_count":7.6,"second_character":"l"},{"first_character":"i","occurrence_count":2.41,"second_character":"m"},{"first_character":"i","occurrence_count":12.01,"second_character":"n"},{"first_character":"i","occurrence_count":3.32,"second_character":"o"},{"first_character":"i","occurrence_count":0.3,"second_character":"p"},{"first_character":"i","occurrence_count":0.29,"second_character":"q"},{"first_character":"i","occurrence_count":4.8,"second_character":"r"},{"first_character":"i","occurrence_count":7.43,"second_character":"s"},{"first_character":"i","occurrence_count":3.06,"second_character":"t"},{"first_character":"i","occurrence_count":0.62,"second_character":"u"},{"first_character":"i","occurrence_count":1.52,"second_character":"v"},{"first_character":"i","occurrence_count":0.05,"second_character":"w"},{"first_character":"i","occurrence_count":0.5,"second_character":"x"},{"first_character":"i","occurrence_count":4.4,"second_character":"y"},{"first_character":"i","occurrence_count":1.56,"second_character":"z"},{"first_character":"j","occurrence_count":2.45,"second_character":"."},{"first_character":"j","occurrence_count":50.79,"second_character":"a"},{"first_character":"j","occurrence_count":0.03,"second_character":"b"},{"first_character":"j","occurrence_count":0.14,"second_character":"c"},{"first_character":"j","occurrence_count":0.14,"second_character":"d"},{"first_character":"j","occurrence_count":15.17,"second_character":"e"},{"first_character":"j","occurrence_count":0.0,"second_character":"f"},{"first_character":"j","occurrence_count":0.0,"second_character":"g"},{"first_character":"j","occurrence_count":1.55,"second_character":"h"},{"first_character":"j","occurrence_count":4.1,"second_character":"i"},{"first_character":"j","occurrence_count":0.07,"second_character":"j"},{"first_character":"j","occurrence_count":0.07,"second_character":"k"},{"first_character":"j","occurrence_count":0.31,"second_character":"l"},{"first_character":"j","occurrence_count":0.17,"second_character":"m"},{"first_character":"j","occurrence_count":0.07,"second_character":"n"},{"first_character":"j","occurrence_count":16.52,"second_character":"o"},{"first_character":"j","occurrence_count":0.03,"second_character":"p"},{"first_character":"j","occurrence_count":0.0,"second_character":"q"},{"first_character":"j","occurrence_count":0.38,"second_character":"r"},{"first_character":"j","occurrence_count":0.24,"second_character":"s"},{"first_character":"j","occurrence_count":0.07,"second_character":"t"},{"first_character":"j","occurrence_count":6.97,"second_character":"u"},{"first_character":"j","occurrence_count":0.17,"second_character":"v"},{"first_character":"j","occurrence_count":0.21,"second_character":"w"},{"first_character":"j","occurrence_count":0.0,"second_character":"x"},{"first_character":"j","occurrence_count":0.34,"second_character":"y"},{"first_character":"j","occurrence_count":0.0,"second_character":"z"},{"first_character":"k","occurrence_count":7.2,"second_character":"."},{"first_character":"k","occurrence_count":34.35,"second_character":"a"},{"first_character":"k","occurrence_count":0.04,"second_character":"b"},{"first_character":"k","occurrence_count":0.04,"second_character":"c"},{"first_character":"k","occurrence_count":0.04,"second_character":"d"},{"first_character":"k","occurrence_count":17.76,"second_character":"e"},{"first_character":"k","occurrence_count":0.02,"second_character":"f"},{"first_character":"k","occurrence_count":0.0,"second_character":"g"},{"first_character":"k","occurrence_count":6.09,"second_character":"h"},{"first_character":"k","occurrence_count":10.1,"second_character":"i"},{"first_character":"k","occurrence_count":0.04,"second_character":"j"},{"first_character":"k","occurrence_count":0.4,"second_character":"k"},{"first_character":"k","occurrence_count":2.76,"second_character":"l"},{"first_character":"k","occurrence_count":0.18,"second_character":"m"},{"first_character":"k","occurrence_count":0.52,"second_character":"n"},{"first_character":"k","occurrence_count":6.83,"second_character":"o"},{"first_character":"k","occurrence_count":0.0,"second_character":"p"},{"first_character":"k","occurrence_count":0.0,"second_character":"q"},{"first_character":"k","occurrence_count":2.16,"second_character":"r"},{"first_character":"k","occurrence_count":1.88,"second_character":"s"},{"first_character":"k","occurrence_count":0.34,"second_character":"t"},{"first_character":"k","occurrence_count":0.99,"second_character":"u"},{"first_character":"k","occurrence_count":0.04,"second_character":"v"},{"first_character":"k","occurrence_count":0.67,"second_character":"w"},{"first_character":"k","occurrence_count":0.0,"second_character":"x"},{"first_character":"k","occurrence_count":7.52,"second_character":"y"},{"first_character":"k","occurrence_count":0.04,"second_character":"z"},{"first_character":"l","occurrence_count":9.41,"second_character":"."},{"first_character":"l","occurrence_count":18.79,"second_character":"a"},{"first_character":"l","occurrence_count":0.37,"second_character":"b"},{"first_character":"l","occurrence_count":0.18,"second_character":"c"},{"first_character":"l","occurrence_count":0.99,"second_character":"d"},{"first_character":"l","occurrence_count":20.93,"second_character":"e"},{"first_character":"l","occurrence_count":0.16,"second_character":"f"},{"first_character":"l","occurrence_count":0.04,"second_character":"g"},{"first_character":"l","occurrence_count":0.14,"second_character":"h"},{"first_character":"l","occurrence_count":17.77,"second_character":"i"},{"first_character":"l","occurrence_count":0.04,"second_character":"j"},{"first_character":"l","occurrence_count":0.17,"second_character":"k"},{"first_character":"l","occurrence_count":9.64,"second_character":"l"},{"first_character":"l","occurrence_count":0.43,"second_character":"m"},{"first_character":"l","occurrence_count":0.1,"second_character":"n"},{"first_character":"l","occurrence_count":4.96,"second_character":"o"},{"first_character":"l","occurrence_count":0.11,"second_character":"p"},{"first_character":"l","occurrence_count":0.02,"second_character":"q"},{"first_character":"l","occurrence_count":0.13,"second_character":"r"},{"first_character":"l","occurrence_count":0.67,"second_character":"s"},{"first_character":"l","occurrence_count":0.55,"second_character":"t"},{"first_character":"l","occurrence_count":2.32,"second_character":"u"},{"first_character":"l","occurrence_count":0.52,"second_character":"v"},{"first_character":"l","occurrence_count":0.11,"second_character":"w"},{"first_character":"l","occurrence_count":0.0,"second_character":"x"},{"first_character":"l","occurrence_count":11.38,"second_character":"y"},{"first_character":"l","occurrence_count":0.07,"second_character":"z"},{"first_character":"m","occurrence_count":7.77,"second_character":"."},{"first_character":"m","occurrence_count":38.99,"second_character":"a"},{"first_character":"m","occurrence_count":1.69,"second_character":"b"},{"first_character":"m","occurrence_count":0.77,"second_character":"c"},{"first_character":"m","occurrence_count":0.36,"second_character":"d"},{"first_character":"m","occurrence_count":12.32,"second_character":"e"},{"first_character":"m","occurrence_count":0.02,"second_character":"f"},{"first_character":"m","occurrence_count":0.0,"second_character":"g"},{"first_character":"m","occurrence_count":0.08,"second_character":"h"},{"first_character":"m","occurrence_count":18.91,"second_character":"i"},{"first_character":"m","occurrence_count":0.11,"second_character":"j"},{"first_character":"m","occurrence_count":0.02,"second_character":"k"},{"first_character":"m","occurrence_count":0.08,"second_character":"l"},{"first_character":"m","occurrence_count":2.53,"second_character":"m"},{"first_character":"m","occurrence_count":0.3,"second_character":"n"},{"first_character":"m","occurrence_count":6.81,"second_character":"o"},{"first_character":"m","occurrence_count":0.57,"second_character":"p"},{"first_character":"m","occurrence_count":0.0,"second_character":"q"},{"first_character":"m","occurrence_count":1.46,"second_character":"r"},{"first_character":"m","occurrence_count":0.53,"second_character":"s"},{"first_character":"m","occurrence_count":0.06,"second_character":"t"},{"first_character":"m","occurrence_count":2.09,"second_character":"u"},{"first_character":"m","occurrence_count":0.05,"second_character":"v"},{"first_character":"m","occurrence_count":0.03,"second_character":"w"},{"first_character":"m","occurrence_count":0.0,"second_character":"x"},{"first_character":"m","occurrence_count":4.32,"second_character":"y"},{"first_character":"m","occurrence_count":0.17,"second_character":"z"},{"first_character":"n","occurrence_count":36.9,"second_character":"."},{"first_character":"n","occurrence_count":16.24,"second_character":"a"},{"first_character":"n","occurrence_count":0.04,"second_character":"b"},{"first_character":"n","occurrence_count":1.16,"second_character":"c"},{"first_character":"n","occurrence_count":3.84,"second_character":"d"},{"first_character":"n","occurrence_count":7.42,"second_character":"e"},{"first_character":"n","occurrence_count":0.06,"second_character":"f"},{"first_character":"n","occurrence_count":1.49,"second_character":"g"},{"first_character":"n","occurrence_count":0.14,"second_character":"h"},{"first_character":"n","occurrence_count":9.41,"second_character":"i"},{"first_character":"n","occurrence_count":0.24,"second_character":"j"},{"first_character":"n","occurrence_count":0.32,"second_character":"k"},{"first_character":"n","occurrence_count":1.06,"second_character":"l"},{"first_character":"n","occurrence_count":0.1,"second_character":"m"},{"first_character":"n","occurrence_count":10.4,"second_character":"n"},{"first_character":"n","occurrence_count":2.71,"second_character":"o"},{"first_character":"n","occurrence_count":0.03,"second_character":"p"},{"first_character":"n","occurrence_count":0.01,"second_character":"q"},{"first_character":"n","occurrence_count":0.24,"second_character":"r"},{"first_character":"n","occurrence_count":1.52,"second_character":"s"},{"first_character":"n","occurrence_count":2.42,"second_character":"t"},{"first_character":"n","occurrence_count":0.52,"second_character":"u"},{"first_character":"n","occurrence_count":0.3,"second_character":"v"},{"first_character":"n","occurrence_count":0.06,"second_character":"w"},{"first_character":"n","occurrence_count":0.03,"second_character":"x"},{"first_character":"n","occurrence_count":2.54,"second_character":"y"},{"first_character":"n","occurrence_count":0.79,"second_character":"z"},{"first_character":"o","occurrence_count":10.78,"second_character":"."},{"first_character":"o","occurrence_count":1.88,"second_character":"a"},{"first_character":"o","occurrence_count":1.76,"second_character":"b"},{"first_character":"o","occurrence_count":1.44,"second_character":"c"},{"first_character":"o","occurrence_count":2.39,"second_character":"d"},{"first_character":"o","occurrence_count":1.66,"second_character":"e"},{"first_character":"o","occurrence_count":0.43,"second_character":"f"},{"first_character":"o","occurrence_count":0.55,"second_character":"g"},{"first_character":"o","occurrence_count":2.16,"second_character":"h"},{"first_character":"o","occurrence_count":0.87,"second_character":"i"},{"first_character":"o","occurrence_count":0.2,"second_character":"j"},{"first_character":"o","occurrence_count":0.86,"second_character":"k"},{"first_character":"o","occurrence_count":7.8,"second_character":"l"},{"first_character":"o","occurrence_count":3.29,"second_character":"m"},{"first_character":"o","occurrence_count":30.39,"second_character":"n"},{"first_character":"o","occurrence_count":1.45,"second_character":"o"},{"first_character":"o","occurrence_count":1.2,"second_character":"p"},{"first_character":"o","occurrence_count":0.04,"second_character":"q"},{"first_character":"o","occurrence_count":13.35,"second_character":"r"},{"first_character":"o","occurrence_count":6.35,"second_character":"s"},{"first_character":"o","occurrence_count":1.49,"second_character":"t"},{"first_character":"o","occurrence_count":3.47,"second_character":"u"},{"first_character":"o","occurrence_count":2.22,"second_character":"v"},{"first_character":"o","occurrence_count":1.44,"second_character":"w"},{"first_character":"o","occurrence_count":0.57,"second_character":"x"},{"first_character":"o","occurrence_count":1.3,"second_character":"y"},{"first_character":"o","occurrence_count":0.68,"second_character":"z"},{"first_character":"p","occurrence_count":3.22,"second_character":"."},{"first_character":"p","occurrence_count":20.37,"second_character":"a"},{"first_character":"p","occurrence_count":0.19,"second_character":"b"},{"first_character":"p","occurrence_count":0.1,"second_character":"c"},{"first_character":"p","occurrence_count":0.0,"second_character":"d"},{"first_character":"p","occurrence_count":19.2,"second_character":"e"},{"first_character":"p","occurrence_count":0.1,"second_character":"f"},{"first_character":"p","occurrence_count":0.0,"second_character":"g"},{"first_character":"p","occurrence_count":19.88,"second_character":"h"},{"first_character":"p","occurrence_count":5.95,"second_character":"i"},{"first_character":"p","occurrence_count":0.1,"second_character":"j"},{"first_character":"p","occurrence_count":0.1,"second_character":"k"},{"first_character":"p","occurrence_count":1.56,"second_character":"l"},{"first_character":"p","occurrence_count":0.1,"second_character":"m"},{"first_character":"p","occurrence_count":0.1,"second_character":"n"},{"first_character":"p","occurrence_count":5.75,"second_character":"o"},{"first_character":"p","occurrence_count":3.8,"second_character":"p"},{"first_character":"p","occurrence_count":0.0,"second_character":"q"},{"first_character":"p","occurrence_count":14.72,"second_character":"r"},{"first_character":"p","occurrence_count":1.56,"second_character":"s"},{"first_character":"p","occurrence_count":1.66,"second_character":"t"},{"first_character":"p","occurrence_count":0.39,"second_character":"u"},{"first_character":"p","occurrence_count":0.0,"second_character":"v"},{"first_character":"p","occurrence_count":0.0,"second_character":"w"},{"first_character":"p","occurrence_count":0.0,"second_character":"x"},{"first_character":"p","occurrence_count":1.17,"second_character":"y"},{"first_character":"p","occurrence_count":0.0,"second_character":"z"},{"first_character":"q","occurrence_count":10.29,"second_character":"."},{"first_character":"q","occurrence_count":4.78,"second_character":"a"},{"first_character":"q","occurrence_count":0.0,"second_character":"b"},{"first_character":"q","occurrence_count":0.0,"second_character":"c"},{"first_character":"q","occurrence_count":0.0,"second_character":"d"},{"first_character":"q","occurrence_count":0.37,"second_character":"e"},{"first_character":"q","occurrence_count":0.0,"second_character":"f"},{"first_character":"q","occurrence_count":0.0,"second_character":"g"},{"first_character":"q","occurrence_count":0.0,"second_character":"h"},{"first_character":"q","occurrence_count":4.78,"second_character":"i"},{"first_character":"q","occurrence_count":0.0,"second_character":"j"},{"first_character":"q","occurrence_count":0.0,"second_character":"k"},{"first_character":"q","occurrence_count":0.37,"second_character":"l"},{"first_character":"q","occurrence_count":0.74,"second_character":"m"},{"first_character":"q","occurrence_count":0.0,"second_character":"n"},{"first_character":"q","occurrence_count":0.74,"second_character":"o"},{"first_character":"q","occurrence_count":0.0,"second_character":"p"},{"first_character":"q","occurrence_count":0.0,"second_character":"q"},{"first_character":"q","occurrence_count":0.37,"second_character":"r"},{"first_character":"q","occurrence_count":0.74,"second_character":"s"},{"first_character":"q","occurrence_count":0.0,"second_character":"t"},{"first_character":"q","occurrence_count":75.74,"second_character":"u"},{"first_character":"q","occurrence_count":0.0,"second_character":"v"},{"first_character":"q","occurrence_count":1.1,"second_character":"w"},{"first_character":"q","occurrence_count":0.0,"second_character":"x"},{"first_character":"q","occurrence_count":0.0,"second_character":"y"},{"first_character":"q","occurrence_count":0.0,"second_character":"z"},{"first_character":"r","occurrence_count":10.84,"second_character":"."},{"first_character":"r","occurrence_count":18.55,"second_character":"a"},{"first_character":"r","occurrence_count":0.32,"second_character":"b"},{"first_character":"r","occurrence_count":0.78,"second_character":"c"},{"first_character":"r","occurrence_count":1.47,"second_character":"d"},{"first_character":"r","occurrence_count":13.36,"second_character":"e"},{"first_character":"r","occurrence_count":0.07,"second_character":"f"},{"first_character":"r","occurrence_count":0.6,"second_character":"g"},{"first_character":"r","occurrence_count":0.95,"second_character":"h"},{"first_character":"r","occurrence_count":23.88,"second_character":"i"},{"first_character":"r","occurrence_count":0.2,"second_character":"j"},{"first_character":"r","occurrence_count":0.71,"second_character":"k"},{"first_character":"r","occurrence_count":3.25,"second_character":"l"},{"first_character":"r","occurrence_count":1.28,"second_character":"m"},{"first_character":"r","occurrence_count":1.1,"second_character":"n"},{"first_character":"r","occurrence_count":6.84,"second_character":"o"},{"first_character":"r","occurrence_count":0.11,"second_character":"p"},{"first_character":"r","occurrence_count":0.13,"second_character":"q"},{"first_character":"r","occurrence_count":3.35,"second_character":"r"},{"first_character":"r","occurrence_count":1.5,"second_character":"s"},{"first_character":"r","occurrence_count":1.64,"second_character":"t"},{"first_character":"r","occurrence_count":1.98,"second_character":"u"},{"first_character":"r","occurrence_count":0.63,"second_character":"v"},{"first_character":"r","occurrence_count":0.17,"second_character":"w"},{"first_character":"r","occurrence_count":0.02,"second_character":"x"},{"first_character":"r","occurrence_count":6.09,"second_character":"y"},{"first_character":"r","occurrence_count":0.18,"second_character":"z"},{"first_character":"s","occurrence_count":14.42,"second_character":"."},{"first_character":"s","occurrence_count":14.82,"second_character":"a"},{"first_character":"s","occurrence_count":0.26,"second_character":"b"},{"first_character":"s","occurrence_count":0.74,"second_character":"c"},{"first_character":"s","occurrence_count":0.11,"second_character":"d"},{"first_character":"s","occurrence_count":10.91,"second_character":"e"},{"first_character":"s","occurrence_count":0.02,"second_character":"f"},{"first_character":"s","occurrence_count":0.02,"second_character":"g"},{"first_character":"s","occurrence_count":15.85,"second_character":"h"},{"first_character":"s","occurrence_count":8.44,"second_character":"i"},{"first_character":"s","occurrence_count":0.02,"second_character":"j"},{"first_character":"s","occurrence_count":1.01,"second_character":"k"},{"first_character":"s","occurrence_count":3.44,"second_character":"l"},{"first_character":"s","occurrence_count":1.11,"second_character":"m"},{"first_character":"s","occurrence_count":0.3,"second_character":"n"},{"first_character":"s","occurrence_count":6.55,"second_character":"o"},{"first_character":"s","occurrence_count":0.63,"second_character":"p"},{"first_character":"s","occurrence_count":0.01,"second_character":"q"},{"first_character":"s","occurrence_count":0.68,"second_character":"r"},{"first_character":"s","occurrence_count":5.69,"second_character":"s"},{"first_character":"s","occurrence_count":9.44,"second_character":"t"},{"first_character":"s","occurrence_count":2.28,"second_character":"u"},{"first_character":"s","occurrence_count":0.17,"second_character":"v"},{"first_character":"s","occurrence_count":0.3,"second_character":"w"},{"first_character":"s","occurrence_count":0.0,"second_character":"x"},{"first_character":"s","occurrence_count":2.65,"second_character":"y"},{"first_character":"s","occurrence_count":0.12,"second_character":"z"},{"first_character":"t","occurrence_count":8.67,"second_character":"."},{"first_character":"t","occurrence_count":18.44,"second_character":"a"},{"first_character":"t","occurrence_count":0.02,"second_character":"b"},{"first_character":"t","occurrence_count":0.31,"second_character":"c"},{"first_character":"t","occurrence_count":0.0,"second_character":"d"},{"first_character":"t","occurrence_count":12.85,"second_character":"e"},{"first_character":"t","occurrence_count":0.04,"second_character":"f"},{"first_character":"t","occurrence_count":0.04,"second_character":"g"},{"first_character":"t","occurrence_count":11.62,"second_character":"h"},{"first_character":"t","occurrence_count":9.55,"second_character":"i"},{"first_character":"t","occurrence_count":0.05,"second_character":"j"},{"first_character":"t","occurrence_count":0.0,"second_character":"k"},{"first_character":"t","occurrence_count":2.41,"second_character":"l"},{"first_character":"t","occurrence_count":0.07,"second_character":"m"},{"first_character":"t","occurrence_count":0.39,"second_character":"n"},{"first_character":"t","occurrence_count":11.97,"second_character":"o"},{"first_character":"t","occurrence_count":0.0,"second_character":"p"},{"first_character":"t","occurrence_count":0.0,"second_character":"q"},{"first_character":"t","occurrence_count":6.32,"second_character":"r"},{"first_character":"t","occurrence_count":0.63,"second_character":"s"},{"first_character":"t","occurrence_count":6.71,"second_character":"t"},{"first_character":"t","occurrence_count":1.4,"second_character":"u"},{"first_character":"t","occurrence_count":0.27,"second_character":"v"},{"first_character":"t","occurrence_count":0.2,"second_character":"w"},{"first_character":"t","occurrence_count":0.04,"second_character":"x"},{"first_character":"t","occurrence_count":6.12,"second_character":"y"},{"first_character":"t","occurrence_count":1.89,"second_character":"z"},{"first_character":"u","occurrence_count":4.94,"second_character":"."},{"first_character":"u","occurrence_count":5.2,"second_character":"a"},{"first_character":"u","occurrence_count":3.29,"second_character":"b"},{"first_character":"u","occurrence_count":3.29,"second_character":"c"},{"first_character":"u","occurrence_count":4.34,"second_character":"d"},{"first_character":"u","occurrence_count":5.39,"second_character":"e"},{"first_character":"u","occurrence_count":0.61,"second_character":"f"},{"first_character":"u","occurrence_count":1.5,"second_character":"g"},{"first_character":"u","occurrence_count":1.85,"second_character":"h"},{"first_character":"u","occurrence_count":3.86,"second_character":"i"},{"first_character":"u","occurrence_count":0.45,"second_character":"j"},{"first_character":"u","occurrence_count":2.97,"second_character":"k"},{"first_character":"u","occurrence_count":9.6,"second_character":"l"},{"first_character":"u","occurrence_count":4.91,"second_character":"m"},{"first_character":"u","occurrence_count":8.77,"second_character":"n"},{"first_character":"u","occurrence_count":0.32,"second_character":"o"},{"first_character":"u","occurrence_count":0.51,"second_character":"p"},{"first_character":"u","occurrence_count":0.32,"second_character":"q"},{"first_character":"u","occurrence_count":13.21,"second_character":"r"},{"first_character":"u","occurrence_count":15.12,"second_character":"s"},{"first_character":"u","occurrence_count":2.62,"second_character":"t"},{"first_character":"u","occurrence_count":0.1,"second_character":"u"},{"first_character":"u","occurrence_count":1.18,"second_character":"v"},{"first_character":"u","occurrence_count":2.74,"second_character":"w"},{"first_character":"u","occurrence_count":1.08,"second_character":"x"},{"first_character":"u","occurrence_count":0.41,"second_character":"y"},{"first_character":"u","occurrence_count":1.44,"second_character":"z"},{"first_character":"v","occurrence_count":3.42,"second_character":"."},{"first_character":"v","occurrence_count":24.95,"second_character":"a"},{"first_character":"v","occurrence_count":0.04,"second_character":"b"},{"first_character":"v","occurrence_count":0.0,"second_character":"c"},{"first_character":"v","occurrence_count":0.04,"second_character":"d"},{"first_character":"v","occurrence_count":22.08,"second_character":"e"},{"first_character":"v","occurrence_count":0.0,"second_character":"f"},{"first_character":"v","occurrence_count":0.0,"second_character":"g"},{"first_character":"v","occurrence_count":0.04,"second_character":"h"},{"first_character":"v","occurrence_count":35.41,"second_character":"i"},{"first_character":"v","occurrence_count":0.0,"second_character":"j"},{"first_character":"v","occurrence_count":0.12,"second_character":"k"},{"first_character":"v","occurrence_count":0.54,"second_character":"l"},{"first_character":"v","occurrence_count":0.0,"second_character":"m"},{"first_character":"v","occurrence_count":0.31,"second_character":"n"},{"first_character":"v","occurrence_count":5.95,"second_character":"o"},{"first_character":"v","occurrence_count":0.0,"second_character":"p"},{"first_character":"v","occurrence_count":0.0,"second_character":"q"},{"first_character":"v","occurrence_count":1.87,"second_character":"r"},{"first_character":"v","occurrence_count":0.0,"second_character":"s"},{"first_character":"v","occurrence_count":0.0,"second_character":"t"},{"first_character":"v","occurrence_count":0.27,"second_character":"u"},{"first_character":"v","occurrence_count":0.27,"second_character":"v"},{"first_character":"v","occurrence_count":0.0,"second_character":"w"},{"first_character":"v","occurrence_count":0.0,"second_character":"x"},{"first_character":"v","occurrence_count":4.7,"second_character":"y"},{"first_character":"v","occurrence_count":0.0,"second_character":"z"},{"first_character":"w","occurrence_count":5.49,"second_character":"."},{"first_character":"w","occurrence_count":30.14,"second_character":"a"},{"first_character":"w","occurrence_count":0.11,"second_character":"b"},{"first_character":"w","occurrence_count":0.0,"second_character":"c"},{"first_character":"w","occurrence_count":0.86,"second_character":"d"},{"first_character":"w","occurrence_count":16.04,"second_character":"e"},{"first_character":"w","occurrence_count":0.22,"second_character":"f"},{"first_character":"w","occurrence_count":0.11,"second_character":"g"},{"first_character":"w","occurrence_count":2.48,"second_character":"h"},{"first_character":"w","occurrence_count":15.93,"second_character":"i"},{"first_character":"w","occurrence_count":0.0,"second_character":"j"},{"first_character":"w","occurrence_count":0.65,"second_character":"k"},{"first_character":"w","occurrence_count":1.4,"second_character":"l"},{"first_character":"w","occurrence_count":0.22,"second_character":"m"},{"first_character":"w","occurrence_count":6.24,"second_character":"n"},{"first_character":"w","occurrence_count":3.88,"second_character":"o"},{"first_character":"w","occurrence_count":0.0,"second_character":"p"},{"first_character":"w","occurrence_count":0.0,"second_character":"q"},{"first_character":"w","occurrence_count":2.37,"second_character":"r"},{"first_character":"w","occurrence_count":2.15,"second_character":"s"},{"first_character":"w","occurrence_count":0.86,"second_character":"t"},{"first_character":"w","occurrence_count":2.69,"second_character":"u"},{"first_character":"w","occurrence_count":0.0,"second_character":"v"},{"first_character":"w","occurrence_count":0.22,"second_character":"w"},{"first_character":"w","occurrence_count":0.0,"second_character":"x"},{"first_character":"w","occurrence_count":7.86,"second_character":"y"},{"first_character":"w","occurrence_count":0.11,"second_character":"z"},{"first_character":"x","occurrence_count":23.53,"second_character":"."},{"first_character":"x","occurrence_count":14.78,"second_character":"a"},{"first_character":"x","occurrence_count":0.14,"second_character":"b"},{"first_character":"x","occurrence_count":0.57,"second_character":"c"},{"first_character":"x","occurrence_count":0.72,"second_character":"d"},{"first_character":"x","occurrence_count":5.16,"second_character":"e"},{"first_character":"x","occurrence_count":0.43,"second_character":"f"},{"first_character":"x","occurrence_count":0.0,"second_character":"g"},{"first_character":"x","occurrence_count":0.14,"second_character":"h"},{"first_character":"x","occurrence_count":14.63,"second_character":"i"},{"first_character":"x","occurrence_count":0.0,"second_character":"j"},{"first_character":"x","occurrence_count":0.0,"second_character":"k"},{"first_character":"x","occurrence_count":5.6,"second_character":"l"},{"first_character":"x","occurrence_count":0.14,"second_character":"m"},{"first_character":"x","occurrence_count":0.14,"second_character":"n"},{"first_character":"x","occurrence_count":5.88,"second_character":"o"},{"first_character":"x","occurrence_count":0.0,"second_character":"p"},{"first_character":"x","occurrence_count":0.0,"second_character":"q"},{"first_character":"x","occurrence_count":0.0,"second_character":"r"},{"first_character":"x","occurrence_count":4.45,"second_character":"s"},{"first_character":"x","occurrence_count":10.04,"second_character":"t"},{"first_character":"x","occurrence_count":0.72,"second_character":"u"},{"first_character":"x","occurrence_count":0.0,"second_character":"v"},{"first_character":"x","occurrence_count":0.43,"second_character":"w"},{"first_character":"x","occurrence_count":5.45,"second_character":"x"},{"first_character":"x","occurrence_count":4.3,"second_character":"y"},{"first_character":"x","occurrence_count":2.73,"second_character":"z"},{"first_character":"y","occurrence_count":20.53,"second_character":"."},{"first_character":"y","occurrence_count":21.92,"second_character":"a"},{"first_character":"y","occurrence_count":0.28,"second_character":"b"},{"first_character":"y","occurrence_count":1.18,"second_character":"c"},{"first_character":"y","occurrence_count":2.78,"second_character":"d"},{"first_character":"y","occurrence_count":3.08,"second_character":"e"},{"first_character":"y","occurrence_count":0.12,"second_character":"f"},{"first_character":"y","occurrence_count":0.31,"second_character":"g"},{"first_character":"y","occurrence_count":0.23,"second_character":"h"},{"first_character":"y","occurrence_count":1.96,"second_character":"i"},{"first_character":"y","occurrence_count":0.24,"second_character":"j"},{"first_character":"y","occurrence_count":0.88,"second_character":"k"},{"first_character":"y","occurrence_count":11.29,"second_character":"l"},{"first_character":"y","occurrence_count":1.51,"second_character":"m"},{"first_character":"y","occurrence_count":18.68,"second_character":"n"},{"first_character":"y","occurrence_count":2.77,"second_character":"o"},{"first_character":"y","occurrence_count":0.15,"second_character":"p"},{"first_character":"y","occurrence_count":0.06,"second_character":"q"},{"first_character":"y","occurrence_count":2.98,"second_character":"r"},{"first_character":"y","occurrence_count":4.1,"second_character":"s"},{"first_character":"y","occurrence_count":1.06,"second_character":"t"},{"first_character":"y","occurrence_count":1.44,"second_character":"u"},{"first_character":"y","occurrence_count":1.08,"second_character":"v"},{"first_character":"y","occurrence_count":0.04,"second_character":"w"},{"first_character":"y","occurrence_count":0.29,"second_character":"x"},{"first_character":"y","occurrence_count":0.24,"second_character":"y"},{"first_character":"y","occurrence_count":0.8,"second_character":"z"},{"first_character":"z","occurrence_count":6.67,"second_character":"."},{"first_character":"z","occurrence_count":35.86,"second_character":"a"},{"first_character":"z","occurrence_count":0.17,"second_character":"b"},{"first_character":"z","occurrence_count":0.08,"second_character":"c"},{"first_character":"z","occurrence_count":0.08,"second_character":"d"},{"first_character":"z","occurrence_count":15.55,"second_character":"e"},{"first_character":"z","occurrence_count":0.0,"second_character":"f"},{"first_character":"z","occurrence_count":0.04,"second_character":"g"},{"first_character":"z","occurrence_count":1.79,"second_character":"h"},{"first_character":"z","occurrence_count":15.18,"second_character":"i"},{"first_character":"z","occurrence_count":0.08,"second_character":"j"},{"first_character":"z","occurrence_count":0.08,"second_character":"k"},{"first_character":"z","occurrence_count":5.13,"second_character":"l"},{"first_character":"z","occurrence_count":1.46,"second_character":"m"},{"first_character":"z","occurrence_count":0.17,"second_character":"n"},{"first_character":"z","occurrence_count":4.59,"second_character":"o"},{"first_character":"z","occurrence_count":0.08,"second_character":"p"},{"first_character":"z","occurrence_count":0.0,"second_character":"q"},{"first_character":"z","occurrence_count":1.33,"second_character":"r"},{"first_character":"z","occurrence_count":0.17,"second_character":"s"},{"first_character":"z","occurrence_count":0.17,"second_character":"t"},{"first_character":"z","occurrence_count":3.04,"second_character":"u"},{"first_character":"z","occurrence_count":0.08,"second_character":"v"},{"first_character":"z","occurrence_count":0.13,"second_character":"w"},{"first_character":"z","occurrence_count":0.04,"second_character":"x"},{"first_character":"z","occurrence_count":6.13,"second_character":"y"},{"first_character":"z","occurrence_count":1.88,"second_character":"z"}]},"layer":[{"encoding":{"color":{"aggregate":"mean","field":"occurrence_count","legend":false,"type":"quantitative"},"x":{"axis":{"labelAngle":0,"orient":"top"},"field":"second_character","type":"nominal"},"y":{"field":"first_character","type":"nominal"}},"mark":{"fillOpacity":1,"tooltip":true,"type":"rect"}},{"encoding":{"text":{"aggregate":"mean","field":"occurrence_count","type":"quantitative"},"x":{"axis":{"labelAngle":0,"orient":"top"},"field":"second_character","type":"nominal"},"y":{"field":"first_character","type":"nominal"}},"mark":"text"}],"width":850}
```

We read the heatmap along each row seeing the probability of each character being the next. We can see that there is a near 30% that `h` is the final letter, or followed by an `a`. Or that 75% of the time we have a `q` then next character will be `u`.

We can create a simple recursive model that samples the next character until we reach the end character `.`

The main function in the model is `Nx.Random.choice/3` which takes in the current key (used in the pseudo-random number generator), the a list of possible indexes as a tensor and the probability matrix.

As an example if we wanted to randomly select either `0` or `1` when the probability of `0` is 90% and the probability of `1` is 10% we could call `choice/3` like this:

```elixir
for i <- 1..10 do
  {res, _key} = Nx.Random.choice(Nx.Random.key(i), Nx.tensor([0, 1]), Nx.tensor([0.9, 0.1]))
  Nx.to_number(res[0])
end
```

<!-- livebook:{"output":true} -->

```
[0, 0, 0, 0, 0, 0, 1, 0, 0, 0]
```

As we can see `0` appears 9 times and `1` only the once.

The recursive model then just handles mapping the selected index to the character and calling the function again until `.` is selected and the built string is returned.

```elixir
defmodule SimpleProbabilityModel do
  def sample(0, acc, _, _) when acc != "", do: acc

  def sample(i, acc, probs, key) do
    {char_index, key} = Nx.Random.choice(key, Nx.tensor(Enum.to_list(0..26)), probs[i])

    char_index = Nx.to_number(char_index[0])
    acc = acc <> BigramMapping.int_to_str(char_index)

    sample(char_index, acc, probs, key)
  end
end
```

<!-- livebook:{"output":true} -->

```
{:module, SimpleProbabilityModel, <<70, 79, 82, 49, 0, 0, 11, ...>>, {:sample, 4}}
```

Running the model ten times with differen random seed shows some nonsensical names that at somewhat look like the shape of real names.

```elixir
simple_prob_model_names =
  for i <- 0..10 do
    SimpleProbabilityModel.sample(
      0,
      "",
      bigram_matrix_probabilites,
      Nx.Random.key(i)
    )
    |> String.trim_trailing(".")
  end
```

<!-- livebook:{"output":true} -->

```
["toler", "stlatabr", "kalliarai", "karilide", "ck", "beena", "sariy", "u", "kiylieleoare",
 "ltlamristuta", "ce"]
```

We can show that the bigram model is at least doing better than random by passing in a uniform distribution where every character has an equal chance of being the next character. As we can see it looks like a completely random mess compared to the bigram model.

```elixir
for i <- 0..15 do
  SimpleProbabilityModel.sample(
    0,
    "",
    Nx.broadcast(1, {27, 27}) |> Nx.divide(27),
    Nx.Random.key(i)
  )
  |> String.trim_trailing(".")
end
```

<!-- livebook:{"output":true} -->

```
["xshktbdtszza", "wwpfwceq", "ojlsofsgjcuuiuclmraoixvelenfrmrtqqlufpeptrrzoqmifebrl",
 "nduqmqhkcgpjqshjyithbmza", "es", "cehrl", "vftrzclkg", "y",
 "nsyprklkscuicjajheakwaskndxfbznxpojhfmyixkofgpjwdgyitjmmrxyi",
 "pvpcnxpvwxxedadsueyiwjtumppdazhfo",
 "ekebyzkdpvhmxhecebjleajmrgusrtmegvczlxoumljumfhokczrxhzdgcpdkunqiduskipape",
 "ljyvoguderarvajtwswfubfbxihnswwdvbfzzmiqufuto", "f", "taqmlooldbcltkpauxckxrtzzzxxffgcussmndfcbd",
 "aefdpyrsa", "kmllcsgqleeslum"]
```

## Loss function

A loss function is required to provide a numerical score for how well the model has performed based on the probabilities we've calculated from the training set.

Log likelihood is commonly used to in cases such as this. It takes the `log` of the probabiliy of each bigram in the produced output, sums the result and normalised by dividing by the number of bigrams.

It's called negative log likelihood as positive number is more commonly used to minimise when training more complicated models.

```elixir
defmodule SimpleProbabilityLoss do
  def negative_log_likelihood(names, bigram_probabilities) do
    bigrams =
      Enum.flat_map(names, &Bigram.from_string/1)
      |> Enum.map(&BigramMapping.encode/1)

    Nx.gather(bigram_probabilities, Nx.tensor(bigrams))
    |> Nx.log()
    |> Nx.sum()
    |> Nx.divide(length(bigrams))
    |> Nx.abs()
  end
end

SimpleProbabilityLoss.negative_log_likelihood(simple_prob_model_names, bigram_matrix_probabilites)
```

<!-- livebook:{"output":true} -->

```
#Nx.Tensor<
  f32
  EXLA.Backend<host:0, 0.293816628.2104623120.10620>
  2.461193561553955
>
```

## Model smoothing

There is an issue with the model right now, if a value is passed with a bigram that has never been seen (e.g. `mq`) then the loss function will return `Inf`.

```elixir
SimpleProbabilityLoss.negative_log_likelihood(["samq"], bigram_matrix_probabilites)
```

<!-- livebook:{"output":true} -->

```
#Nx.Tensor<
  f32
  EXLA.Backend<host:0, 0.293816628.2104623120.10628>
  Inf
>
```

To fix this add 1 to each count to avoid any individual count being equal to
zero.

This is called model smoothing which helps makes the model more
uniform. Adding one helps reduce the impact of zeros, but in theory
you could add 1 million which would make every option practically
equally as likely.

```elixir
bigram_matrix = Nx.add(bigram_matrix, 1)

bigram_matrix_probabilites =
  Nx.divide(
    bigram_matrix,
    Nx.sum(bigram_matrix, axes: [1], keep_axes: true)
  )
```

<!-- livebook:{"output":true} -->

```
#Nx.Tensor<
  f32[27][27]
  EXLA.Backend<host:0, 0.293816628.2104623120.10632>
  [
    [3.119151733699255e-5, 0.13758577406406403, 0.04076731204986572, 0.048128508031368256, 0.05274485424160957, 0.047785401344299316, 0.01303805410861969, 0.02089831605553627, 0.02729257568717003, 0.018465377390384674, 0.07557704299688339, 0.09245165437459946, 0.04906425625085831, 0.07919526100158691, 0.035776667296886444, 0.01232064887881279, 0.01609482243657112, 0.0029008109122514725, 0.051154084503650665, 0.06412975490093231, 0.040829695761203766, 0.0024641298223286867, 0.011759201064705849, 0.009606987237930298, 0.004210854414850473, 0.016718652099370956, 0.029008109122514725],
    [0.19583038985729218, 0.016424864530563354, 0.01598254218697548, 0.013888888992369175, 0.03075607493519783, 0.020435243844985962, 0.003980891779065132, 0.004983486607670784, 0.06879570335149765, 0.04868483170866966, 0.005189903080463409, 0.016778720542788506, 0.07457537204027176, 0.04821302369236946, 0.16038569808006287, 0.0018872375367209315, 0.002447511302307248, 0.0017987733008340001, 0.0962786003947258, 0.032997168600559235, 0.020287804305553436, 0.01126444898545742, 0.02462255209684372, ...],
    ...
  ]
>
```

```elixir
SimpleProbabilityLoss.negative_log_likelihood(["samq"], bigram_matrix_probabilites)
```

<!-- livebook:{"output":true} -->

```
#Nx.Tensor<
  f32
  EXLA.Backend<host:0, 0.293816628.2104623120.10637>
  3.765857696533203
>
```

## Simple neural network approach

A neural network can be used to approximate the same model by passing in the first character and returning a set of probabilites for the character that should follow.

```elixir
names_to_input_output_bigrams = fn names ->
  bigrams =
    names
    |> Enum.flat_map(&Bigram.from_string/1)
    |> Enum.map(&BigramMapping.encode/1)
    |> Nx.tensor()

  {bigrams[[.., 0]], bigrams[[.., 1]]}
end

{inputs, outputs} =
  names_to_input_output_bigrams.(["sam"])
```

<!-- livebook:{"output":true} -->

```
{#Nx.Tensor<
   s32[4]
   EXLA.Backend<host:0, 0.293816628.2104623120.10641>
   [0, 19, 1, 13]
 >,
 #Nx.Tensor<
   s32[4]
   EXLA.Backend<host:0, 0.293816628.2104623120.10644>
   [19, 1, 13, 0]
 >}
```

Passing a single integer to the network which will be multipled by various weights doesn't work as well as passing in a one-hot-encoding vector which is set to `1` at the index of the charater while the rest remain zero. So if the vocabulary was only `a, b, c` which mapped to `0, 1, 2`, the one hot encoding for `a` would be `[1, 0, 0]`, and `b` would be `[0, 1, 0]`

```elixir
one_hot_encode = fn tensor ->
  tensor
  |> Nx.new_axis(-1)
  |> Nx.equal(Nx.iota({vocabulary_size}))
end

inputs = one_hot_encode.(inputs)
```

<!-- livebook:{"output":true} -->

```
#Nx.Tensor<
  u8[4][27]
  EXLA.Backend<host:0, 0.293816628.2104623120.10650>
  [
    [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, ...],
    ...
  ]
>
```

For this simple neural network there will only be weights with no bias or activation function. A single layer of 27 neurons with each taking 27 inputs requires and tensor with the shape `{27, 27}`.

```elixir
key = Nx.Random.key(42)

{weights, key} = Nx.Random.normal(key, shape: {27, 27})

weights
```

<!-- livebook:{"output":true} -->

```
#Nx.Tensor<
  f32[27][27]
  EXLA.Backend<host:0, 0.293816628.2104623120.11175>
  [
    [-1.3813380002975464, 1.1619457006454468, 0.4389880895614624, 0.47841933369636536, -0.01944045163691044, 0.7200543880462646, -1.2873157262802124, 1.8024386167526245, -0.6541416645050049, 2.333552598953247, 0.008432986214756966, 1.7843825817108154, -1.331638216972351, 0.37328076362609863, 1.0773977041244507, -0.050300661474466324, -0.5105248689651489, 0.6116188168525696, 0.9199008941650391, -0.2440028339624405, 0.042304638773202896, 0.3097541928291321, -0.5302157998085022, 0.32695192098617554, -1.0410704612731934, -0.9639928340911865, 0.3592979907989502],
    [1.683728814125061, -0.024233371019363403, -0.516905665397644, 1.0823928117752075, -0.5861626267433167, 1.0994369983673096, -0.647191047668457, 0.37540796399116516, -0.4925920367240906, -1.3620562553405762, -0.4493446946144104, -1.504736065864563, 0.6882826685905457, 0.3561391234397888, 1.356558084487915, 0.15918461978435516, 0.09364021569490433, 1.0270025730133057, -2.107351064682007, 1.587530255317688, -1.3589147329330444, 0.7119573950767517, 3.3185901641845703, ...],
    ...
  ]
>
```

Taking the dot product of the inputs by the weights returns the activations of each neuron in the layer. These values cannot currently be used as a probability distribution since some values are negative and have different ranges.

To solve this the logits (result from the dot product) is exponentiated to remove the negatives, then the values are normalised so each of the rows sum to 1. Note: This is also known as softmax, which produces an output that has only positive values and sums to 1.

```elixir
logits = Nx.dot(inputs, weights)
counts = Nx.exp(logits)

untrained_network_probabilites =
  Nx.divide(
    counts,
    Nx.sum(counts, axes: [1], keep_axes: true)
  )
```

<!-- livebook:{"output":true} -->

```
#Nx.Tensor<
  f32[4][27]
  EXLA.Backend<host:0, 0.293816628.2104623120.11185>
  [
    [0.004861924331635237, 0.06185036897659302, 0.03001689724624157, 0.031224144622683525, 0.01897897571325302, 0.03975862264633179, 0.0053412336856126785, 0.11735587567090988, 0.01006063912063837, 0.1996019035577774, 0.019515426829457283, 0.11525589972734451, 0.005109666381031275, 0.028107965365052223, 0.05683600530028343, 0.018402226269245148, 0.01161442045122385, 0.03567289561033249, 0.048553839325904846, 0.015161653980612755, 0.02018776908516884, 0.026377899572253227, 0.011387959122657776, 0.02683546394109726, 0.006832576356828213, 0.007380042690783739, 0.027717676013708115],
    [0.058093924075365067, 0.0454820916056633, 0.05167889967560768, 0.07422308623790741, 0.011480205692350864, 0.05333520472049713, 0.007877768017351627, 0.023267574608325958, 0.03405758738517761, 0.017352519556879997, 0.05348069593310356, 0.02075742930173874, 0.009526808746159077, 0.15203088521957397, 0.006109711714088917, 0.003009348176419735, 0.052116766571998596, 0.011071586050093174, 0.044853758066892624, 0.02339315600693226, 0.010454589501023293, 0.0041312891989946365, 0.06633784621953964, ...],
    ...
  ]
>
```

The result of passing three names into the untrained network results in a loss of 3.8712. Stepping through what we have done:

Given the name `sam`, which becomes the bigrams `[[., s], [s, a], [a, m], [m, .]]` encoded to `[[0, 19], [19, 1], [1, 13], [13, 0]]`.

These bigrams are then one hot encoded to map an array full of zeros except at the index of the character which is one. The one hot encoded vectors were passed to the neural net (just 27 weights each taking 27 inputs). We then softmax the result of the network to create the probabilites of what characters come next.

So taking the bigram `[s, a]` (i.e `[19, 1]`) for example. By running "sam" through the same process as before we end up with the probabilities for each bigram. `s` as the input is the second row of the probabilities matrix where each number is the probability of that character being the next character. This shows that the actual next character `a` have a `~4.5%` probability according the network.

```elixir
untrained_network_probabilites[1]
```

<!-- livebook:{"output":true} -->

```
#Nx.Tensor<
  f32[27]
  EXLA.Backend<host:0, 0.293816628.2104623120.11188>
  [0.058093924075365067, 0.0454820916056633, 0.05167889967560768, 0.07422308623790741, 0.011480205692350864, 0.05333520472049713, 0.007877768017351627, 0.023267574608325958, 0.03405758738517761, 0.017352519556879997, 0.05348069593310356, 0.02075742930173874, 0.009526808746159077, 0.15203088521957397, 0.006109711714088917, 0.003009348176419735, 0.052116766571998596, 0.011071586050093174, 0.044853758066892624, 0.02339315600693226, 0.010454589501023293, 0.0041312891989946365, 0.06633784621953964, 0.014337228611111641, 0.08794016391038895, 0.061035700142383575, 0.0025642095133662224]
>
```

Taking the negative log of this gives the loss for this single example of `~3.1`. For reference the final model will have a loss under `1.0` so this is not great, but also expected from a random, untrained model.

```elixir
untrained_network_probabilites[1][1]
|> Nx.log()
|> Nx.abs()
```

<!-- livebook:{"output":true} -->

```
#Nx.Tensor<
  f32
  EXLA.Backend<host:0, 0.293816628.2104623120.11195>
  3.0904366970062256
>
```

## Neural network loss

There are two problems with the current Loss function:

1. It takes in a list of names as strings, which are then converted to bigrams and encoded. Doing this every time the loss is calculated is inefficient.
2. It expects the probabilities to be in the shape `{27, 27}`, to then lookup the probability by the index of the leading character, then the index of the following character.

The probabilites from the neural network will be 27 values for each input given, so for this one example `{4, 27}`.

The loss function then gathers the networks predicted probability by looking up the index of the following character for each row in the predictions. This means the loss can be calculated for as many examples in one calculation.

```elixir
defmodule Loss do
  def negative_log_likelihood(expected_outputs, probabilities) do
    indicies =
      [Nx.iota(Nx.shape(expected_outputs)), expected_outputs]
      |> Nx.stack(axis: 1)

    Nx.gather(probabilities, indicies)
    |> Nx.log()
    |> Nx.mean()
    |> Nx.abs()
  end

  def negative_log_likelihood({expected_outputs, probabilities}) do
    negative_log_likelihood(expected_outputs, probabilities)
  end
end

Loss.negative_log_likelihood(outputs, untrained_network_probabilites)
```

<!-- livebook:{"output":true} -->

```
#Nx.Tensor<
  f32
  EXLA.Backend<host:0, 0.293816628.2104623120.11205>
  3.534393072128296
>
```

## Training the network

Bringing all of this together into a single module, a model can be initialised with random weights, used to created the probabilities for a given input (or set of inputs) and a training function to update the weights.

`Nx`, like `PyTorch`, can automatically calculate the gradients for the intermediate values in a function. `Nx.Defn.value_and_grads/2` takes the input tensors to be used in the forward and backwards passes, and a function which accepts these args returning a tuple containing the loss and the gradients of all of the input tensors.

The gradients of the weights are then used to updated the weights in the direction to reduce the loss by a passed in step size.

```elixir
defmodule SimpleNeuralNetwork do
  def init(opts \\ []) do
    seed = Keyword.get(opts, :seed, 42)
    key = Nx.Random.key(seed)
    {weights, _new_key} = Nx.Random.normal(key, shape: {27, 27})

    weights
  end

  def predict(inputs, weights) do
    Nx.dot(inputs, weights)
    |> Nx.exp()
    |> then(&Nx.divide(&1, Nx.sum(&1, axes: [1], keep_axes: true)))
  end

  def train_weights(weights, inputs, expected_outputs, opts \\ []) do
    {loss, {weight_grads, _input_grads, _output_grads}} =
      Nx.Defn.value_and_grad({weights, inputs, expected_outputs},
        fn {weights, inputs, outputs} ->
          probabilites = predict(inputs, weights)
          Loss.negative_log_likelihood(outputs, probabilites)
        end
      )

    step_size = Keyword.get(opts, :step_size, 0.1)

    updated_weights =
      weight_grads
      |> Nx.multiply(-step_size)
      |> Nx.add(weights)

    {loss, updated_weights}
  end
end
```

<!-- livebook:{"output":true} -->

```
{:module, SimpleNeuralNetwork, <<70, 79, 82, 49, 0, 0, 16, ...>>, {:train_weights, 4}}
```

```elixir
{inputs, outputs} =
  names
  |> names_to_input_output_bigrams.()

inputs = one_hot_encode.(inputs)
init_weights = SimpleNeuralNetwork.init(seed: 2)

probabilites = SimpleNeuralNetwork.predict(inputs, init_weights)
initial_loss = Loss.negative_log_likelihood(outputs, probabilites)

IO.write("Initial loss: #{Nx.to_number(initial_loss)}\n")

step_size = 10

trained_weights =
  Enum.reduce(1..10, init_weights, fn i, weights ->
    {loss, updated_weights} =
      SimpleNeuralNetwork.train_weights(weights, inputs, outputs, step_size: 50)

    IO.write("Iteration #{i}: current loss: #{Nx.to_number(loss)}\r")

    updated_weights
  end)

probabilites = SimpleNeuralNetwork.predict(inputs, trained_weights)
initial_loss = Loss.negative_log_likelihood(outputs, probabilites)

IO.write("\nFinal loss: #{Nx.to_number(initial_loss)}\n")
```

<!-- livebook:{"output":true} -->

```
Initial loss: 3.782604694366455
Iteration 10: current loss: 2.6894264221191406
Final loss: 2.667579412460327
```

<!-- livebook:{"output":true} -->

```
:ok
```

What's interesting is the loss from the simple neural network equals the loss achieved with the simple bigram model based just on counts of the occurances of each bigram. This intuitavely makes sense when looking at the result of the dot product of the inputs and the weights.

Since the inputs are one hot encoded only one of the 27 neurons in the weights will be multipled by 1, while the rest are multipled by zero so effectively cancelled out. This is another way of describing selecting one row from 27, the same as the simple model.

The training then adjusts the weights to approximately match the probabilites from the counts model.

These resulting probabilities can be passed into the sampling model to produce results that appear quite similar to the results from the previous model.

```elixir
simple_prob_model_names =
  for i <- 0..10 do
    SimpleProbabilityModel.sample(
      0,
      "",
      probabilites,
      Nx.Random.key(i)
    )
    |> String.trim_trailing(".")
  end
```

<!-- livebook:{"output":true} -->

```
["tpejr", "stmdtban", "lijrkcnhearteralknaniwpcechanknunqgodnemrpmylmlgba", "k", "cn", "aaemlaltwk",
 "scpnyalja", "v", "koymnijeo", "lsnciwivutva", "cecawyjanwekxha"]
```

## Multi layered perceptron approach

The simple neural "network" approach could only match the bigram counting model, but with an improved architecture to make an actual network of neurons it is possible to create a model that can achieve the goal of creating outputs that do actually look like names based on the dataset.

The main issue is the models thus far only consider a single character as input, not the full context of characters that lead to the next character.

This approach will be largely based on the 2003 paper [_A Neural Probabilistic Language Model_](https://www.jmlr.org/papers/volume3/bengio03a/bengio03a.pdf). The paper was not the first to use this approach, but it is frequently cited and is considered infliential in the progress on language models. Note: the paper uses a word level language model, while this notebook is following the character level language model from Andrej Karpathy's video series.

It will introduce the concept of embeddings where each character is assinged a vector (of 2 values in this notebook) which will be trained as part of the network and an additional hidden layer with a configurable number of neurons in the layer.

#### Train test split

The names are first shuffled, mapped to tensors and then split so that 80% of the data is used for training the model, 10% is used to test the progress and 10% is held back to validate the final result. This is a strategy to avoid overfitting the model to the training data and measure how well it generalises to data never seen before.

```elixir
# set random seed for Nx
key = Nx.Random.key(42)
# set random seed to Enum.shuffle
:rand.seed(:exsss, {11, 22, 33})

block_size = 3

[
  {train_inputs, train_targets},
  {test_inputs, test_targets},
  {validation_inputs, validation_targets}
] =
  names
  |> Enum.shuffle()
  |> Enum.flat_map(& Bigram.from_string(&1, block_size: block_size))
  |> Enum.map(&BigramMapping.encode/1)
  |> Nx.tensor()
  |> Nx.split(0.2)
  |> then(fn {test_val, train} ->
    {test, val} = Nx.split(test_val, 0.5)
    [train, test, val]
  end)
  |> Enum.map(& {&1[[.., 0..2]], &1[[.., 3]]})

%{
  train_input: Nx.shape(train_inputs),
  train_targets: Nx.shape(train_targets),
  test_inputs: Nx.shape(test_inputs),
  test_targets: Nx.shape(test_targets),
  validation_inputs: Nx.shape(validation_inputs),
  validation_targets: Nx.shape(validation_targets)
}
```

<!-- livebook:{"output":true} -->

```
%{
  train_targets: {182516},
  test_inputs: {22815, 3},
  test_targets: {22815},
  validation_inputs: {22815, 3},
  validation_targets: {22815},
  train_input: {182516, 3}
}
```

The embedding lookup table is shared by the input characters to the network (3 characters to match the paper). Each character passed in as input will be mapped to the embedding at the index of the value. So `a` is located on the second row and is used for calculations being passed through the network.

```elixir
embedding_size = 2

{embeddings_lookup_table, key} = Nx.Random.normal(key, shape: {27, embedding_size})
embeddings_lookup_table
```

<!-- livebook:{"output":true} -->

```
#Nx.Tensor<
  f32[27][2]
  EXLA.Backend<host:0, 0.293816628.2104623120.85676>
  [
    [-0.4588238298892975, -0.4479961395263672],
    [0.048698700964450836, 1.1304913759231567],
    [0.3017951250076294, -2.2387630939483643],
    [0.09863251447677612, -1.2525713443756104],
    [-0.3293994963169098, 0.4832535982131958],
    [-0.17657697200775146, -0.061122581362724304],
    [0.3453143239021301, 0.9920694231987],
    [-0.7586308121681213, -1.8297280073165894],
    [0.15444186329841614, -0.3191068172454834],
    [-0.5861104726791382, -0.6225448250770569],
    [1.8845003843307495, -0.9263893961906433],
    [-0.1849275529384613, -1.1263865232467651],
    [-0.24176543951034546, -0.5562043786048889],
    [0.8305839896202087, 1.0440659523010254],
    [0.08007731288671494, 0.7823209166526794],
    [0.6714229583740234, -0.11029913276433945],
    [0.1599046140909195, 0.8102514743804932],
    [0.18259650468826294, -0.062168922275304794],
    [0.07375185936689377, 1.2513036727905273],
    [-0.44436749815940857, -1.2168940305709839],
    [-1.4224790334701538, 0.5164517164230347],
    [1.5045603513717651, 0.05762374401092529],
    [0.18425266444683075, 0.40708044171333313],
    [1.206267237663269, 0.5631315112113953],
    [-1.8897922039031982, 1.1783827543258667],
    ...
  ]
>
```

The training input data can be mapped to the relevant embeddings by passing the tensor in as the lookup. This works since the input tensor gives the shape needed and each integer represents the indexed to be retrieved from the embedding lookup table.

```elixir
embeddings_lookup_table[train_inputs]
```

<!-- livebook:{"output":true} -->

```
#Nx.Tensor<
  f32[182516][3][2]
  EXLA.Backend<host:0, 0.293816628.2104623120.85680>
  [
    [
      [0.3017951250076294, -2.2387630939483643],
      [0.048698700964450836, 1.1304913759231567],
      [-0.44436749815940857, -1.2168940305709839]
    ],
    [
      [0.048698700964450836, 1.1304913759231567],
      [-0.44436749815940857, -1.2168940305709839],
      [0.15444186329841614, -0.3191068172454834]
    ],
    [
      [-0.44436749815940857, -1.2168940305709839],
      [0.15444186329841614, -0.3191068172454834],
      [0.048698700964450836, 1.1304913759231567]
    ],
    [
      [0.15444186329841614, -0.3191068172454834],
      [0.048698700964450836, 1.1304913759231567],
      [0.07375185936689377, 1.2513036727905273]
    ],
    [
      [-0.4588238298892975, -0.4479961395263672],
      [-0.4588238298892975, -0.4479961395263672],
      [-0.4588238298892975, -0.4479961395263672]
    ],
    [
      [-0.4588238298892975, -0.4479961395263672],
      [-0.4588238298892975, -0.4479961395263672],
      [-0.1849275529384613, -1.1263865232467651]
    ],
    [
      [-0.4588238298892975, -0.4479961395263672],
      [-0.1849275529384613, -1.1263865232467651],
      [-0.5861104726791382, -0.6225448250770569]
    ],
    [
      [-0.1849275529384613, -1.1263865232467651],
      [-0.5861104726791382, -0.6225448250770569],
      [0.08007731288671494, 0.7823209166526794]
    ],
    [
      [-0.5861104726791382, -0.6225448250770569],
      ...
    ],
    ...
  ]
>
```

```elixir
defmodule MLPModel do
  import Nx.Defn

  def new(opts \\ []) do
    seed = Keyword.get(opts, :seed, 42)
    key = Keyword.get(opts, :key, Nx.Random.key(seed))

    hidden_weights_count = Keyword.get(opts, :hidden_weights_count, 100)
    vocabulary_size = Keyword.get(opts, :vocabulary_size, 27)
    embedding_size = Keyword.get(opts, :embedding_size, 2)
    block_size = Keyword.get(opts, :block_size, 3)

    {emb, key} = Nx.Random.normal(key, shape: {vocabulary_size, embedding_size})

    {w1, key} = Nx.Random.normal(key, shape: {embedding_size * block_size, hidden_weights_count})
    {b1, key} = Nx.Random.normal(key, shape: {hidden_weights_count})
    {w2, key} = Nx.Random.normal(key, shape: {hidden_weights_count, vocabulary_size})
    {b2, _key} = Nx.Random.normal(key, shape: {vocabulary_size})

    {emb, w1, b1, w2, b2}
  end

  defn predict({emb, w1, b1, w2, b2} = _params, inputs, opts \\ []) do
    opts = validate_opts(opts)

    batch_size = opts[:batch_size]
    input_size = opts[:input_size]

    emb[inputs]
    |> Nx.reshape({batch_size, input_size})
    |> Nx.dot(w1)
    |> Nx.add(b1)
    |> Nx.tanh()
    |> Nx.dot(w2)
    |> Nx.add(b2)
  end

  defn loss(params, inputs, targets, opts \\ []) do
    logits = predict(params, inputs, opts)

    Axon.Losses.categorical_cross_entropy(
      targets,
      logits,
      from_logits: true,
      sparse: true,
      reduction: :mean
    )
  end

  defn train({emb, w1, b1, w2, b2} = params, inputs, targets, key, opts \\ []) do
    opts = validate_opts(opts)

    batch_size = opts[:batch_size]
    total_inputs = elem(Nx.shape(inputs), 0)

    {input_indicies, key} = Nx.Random.randint(key, 0, total_inputs, shape: {batch_size})

    batch_inputs = inputs[input_indicies]
    batch_targets = targets[input_indicies]

    {
      loss,
      {emb_grad, w1_grad, b1_grad, w2_grad, b2_grad}
    } = Nx.Defn.value_and_grad(
      params,
      & loss(&1, batch_inputs, batch_targets, opts)
    )

    step_size = -opts[:step_size]

    {
      loss,
      {
        emb_grad |> Nx.multiply(step_size)|> Nx.add(emb),
        w1_grad |> Nx.multiply(step_size) |> Nx.add(w1),
        b1_grad |> Nx.multiply(step_size) |> Nx.add(b1),
        w2_grad |> Nx.multiply(step_size) |> Nx.add(w2),
        b2_grad |> Nx.multiply(step_size) |> Nx.add(b2)
      },
      key
    }
  end

  defn validate_opts(opts) do
    keyword!(
      opts,
      key: Nx.Random.key(42),
      batch_size: 32,
      input_size: 6,
      step_size: 0.1
    )
  end
end
```

<!-- livebook:{"output":true} -->

```
{:module, MLPModel, <<70, 79, 82, 49, 0, 0, 41, ...>>, true}
```

```elixir
seed = 42
key = Nx.Random.key(seed)

init_params = MLPModel.new(seed: seed)

{trained_params, _key, losses} =
  for i <- 1..1000, reduce: {init_params, key, []} do
    {params, key, losses} ->
      {loss, updated_params, key} =
        MLPModel.train(params, train_inputs, train_targets, key, batch_size: 32)
  
      IO.write("Iteration: #{i}, Current loss: #{Nx.to_number(loss)}\r")
  
      {updated_params, key, [%{i: i, loss: Nx.to_number(loss)} | losses]}
  end

loss =
  MLPModel.loss(
    trained_params,
    validation_inputs,
    validation_targets,
    batch_size: elem(Nx.shape(validation_targets), 0)
  )

IO.write("\nFinal loss on all data: #{Nx.to_number(loss)}")

Tucan.lineplot(losses, "i", "loss", width: 800, height: 400)
```

<!-- livebook:{"output":true} -->

```
Iteration: 1000, Current loss: 2.6478610038757324
Final loss on all data: 2.655039072036743
```

<!-- livebook:{"output":true} -->

```vega-lite
{"$schema":"https://vega.github.io/schema/vega-lite/v5.json","__tucan__":{"types":{"i":"quantitative","loss":"quantitative"}},"data":{"values":[{"i":1000,"loss":2.6478610038757324},{"i":999,"loss":2.728991746902466},{"i":998,"loss":2.6202542781829834},{"i":997,"loss":2.600111961364746},{"i":996,"loss":2.8877363204956055},{"i":995,"loss":2.6523056030273438},{"i":994,"loss":2.534067392349243},{"i":993,"loss":2.3950629234313965},{"i":992,"loss":2.5758233070373535},{"i":991,"loss":2.74822735786438},{"i":990,"loss":2.3743820190429688},{"i":989,"loss":2.660601854324341},{"i":988,"loss":2.462980031967163},{"i":987,"loss":2.598527193069458},{"i":986,"loss":2.4171693325042725},{"i":985,"loss":2.7162179946899414},{"i":984,"loss":2.4718260765075684},{"i":983,"loss":2.7777085304260254},{"i":982,"loss":2.666748523712158},{"i":981,"loss":2.5190303325653076},{"i":980,"loss":2.841303825378418},{"i":979,"loss":2.462123155593872},{"i":978,"loss":2.721811532974243},{"i":977,"loss":2.5823490619659424},{"i":976,"loss":2.4474940299987793},{"i":975,"loss":2.3937366008758545},{"i":974,"loss":2.519718647003174},{"i":973,"loss":2.32928466796875},{"i":972,"loss":2.6403117179870605},{"i":971,"loss":2.6109139919281006},{"i":970,"loss":2.922278642654419},{"i":969,"loss":2.681851625442505},{"i":968,"loss":2.5661025047302246},{"i":967,"loss":2.694460868835449},{"i":966,"loss":2.733823537826538},{"i":965,"loss":2.772977352142334},{"i":964,"loss":2.6091458797454834},{"i":963,"loss":2.546367883682251},{"i":962,"loss":2.8362064361572266},{"i":961,"loss":2.793208122253418},{"i":960,"loss":2.8106114864349365},{"i":959,"loss":2.481574058532715},{"i":958,"loss":2.8072896003723145},{"i":957,"loss":2.6273412704467773},{"i":956,"loss":3.062854290008545},{"i":955,"loss":2.686795949935913},{"i":954,"loss":2.9087727069854736},{"i":953,"loss":2.699284791946411},{"i":952,"loss":2.8798885345458984},{"i":951,"loss":2.759678363800049},{"i":950,"loss":2.4037997722625732},{"i":949,"loss":2.758955240249634},{"i":948,"loss":3.191220760345459},{"i":947,"loss":2.6155130863189697},{"i":946,"loss":2.3228471279144287},{"i":945,"loss":2.9112651348114014},{"i":944,"loss":2.648768424987793},{"i":943,"loss":2.9865825176239014},{"i":942,"loss":2.385545253753662},{"i":941,"loss":2.8550593852996826},{"i":940,"loss":2.3630306720733643},{"i":939,"loss":2.7377769947052},{"i":938,"loss":2.4906389713287354},{"i":937,"loss":2.5024654865264893},{"i":936,"loss":2.7320094108581543},{"i":935,"loss":2.754016876220703},{"i":934,"loss":2.93038010597229},{"i":933,"loss":2.972180128097534},{"i":932,"loss":2.669947624206543},{"i":931,"loss":2.613694906234741},{"i":930,"loss":2.389284133911133},{"i":929,"loss":3.2938265800476074},{"i":928,"loss":2.858377456665039},{"i":927,"loss":2.2772107124328613},{"i":926,"loss":2.4629149436950684},{"i":925,"loss":2.3507497310638428},{"i":924,"loss":2.553945541381836},{"i":923,"loss":2.049156904220581},{"i":922,"loss":2.1788694858551025},{"i":921,"loss":2.5432276725769043},{"i":920,"loss":2.677786111831665},{"i":919,"loss":2.2267634868621826},{"i":918,"loss":2.7243449687957764},{"i":917,"loss":2.6953327655792236},{"i":916,"loss":2.6548097133636475},{"i":915,"loss":2.7803943157196045},{"i":914,"loss":2.8801982402801514},{"i":913,"loss":2.466547727584839},{"i":912,"loss":2.534668207168579},{"i":911,"loss":2.75783109664917},{"i":910,"loss":2.7454235553741455},{"i":909,"loss":2.7890443801879883},{"i":908,"loss":3.0198261737823486},{"i":907,"loss":2.4524893760681152},{"i":906,"loss":2.5502333641052246},{"i":905,"loss":2.6352744102478027},{"i":904,"loss":2.7102532386779785},{"i":903,"loss":2.572282075881958},{"i":902,"loss":2.51094388961792},{"i":901,"loss":2.363084554672241},{"i":900,"loss":2.435678243637085},{"i":899,"loss":2.7804417610168457},{"i":898,"loss":2.850327730178833},{"i":897,"loss":2.531355619430542},{"i":896,"loss":2.9580721855163574},{"i":895,"loss":2.8945586681365967},{"i":894,"loss":2.7005867958068848},{"i":893,"loss":2.5440495014190674},{"i":892,"loss":2.5141589641571045},{"i":891,"loss":2.473365306854248},{"i":890,"loss":2.9381325244903564},{"i":889,"loss":2.804546356201172},{"i":888,"loss":2.410468101501465},{"i":887,"loss":2.8426876068115234},{"i":886,"loss":2.6738879680633545},{"i":885,"loss":2.780510187149048},{"i":884,"loss":2.7320683002471924},{"i":883,"loss":2.6373541355133057},{"i":882,"loss":3.120506763458252},{"i":881,"loss":2.5506043434143066},{"i":880,"loss":2.8479645252227783},{"i":879,"loss":2.2936699390411377},{"i":878,"loss":2.9448230266571045},{"i":877,"loss":2.7384486198425293},{"i":876,"loss":2.495443820953369},{"i":875,"loss":2.9793527126312256},{"i":874,"loss":2.6110801696777344},{"i":873,"loss":2.6637372970581055},{"i":872,"loss":2.933403968811035},{"i":871,"loss":2.5438344478607178},{"i":870,"loss":2.8014256954193115},{"i":869,"loss":2.3551759719848633},{"i":868,"loss":2.742701768875122},{"i":867,"loss":2.418280601501465},{"i":866,"loss":2.62326979637146},{"i":865,"loss":2.6258232593536377},{"i":864,"loss":2.664302349090576},{"i":863,"loss":2.3407528400421143},{"i":862,"loss":3.1424903869628906},{"i":861,"loss":2.724421739578247},{"i":860,"loss":2.2481436729431152},{"i":859,"loss":2.4406378269195557},{"i":858,"loss":2.4951846599578857},{"i":857,"loss":2.509007453918457},{"i":856,"loss":2.514180898666382},{"i":855,"loss":2.945707321166992},{"i":854,"loss":2.8087315559387207},{"i":853,"loss":2.631171464920044},{"i":852,"loss":2.62271785736084},{"i":851,"loss":2.720613718032837},{"i":850,"loss":2.5909814834594727},{"i":849,"loss":2.616365432739258},{"i":848,"loss":2.8354673385620117},{"i":847,"loss":2.4049530029296875},{"i":846,"loss":2.8472230434417725},{"i":845,"loss":3.1106462478637695},{"i":844,"loss":2.691258192062378},{"i":843,"loss":2.659125566482544},{"i":842,"loss":2.4546995162963867},{"i":841,"loss":2.763205051422119},{"i":840,"loss":2.9371163845062256},{"i":839,"loss":2.599864959716797},{"i":838,"loss":2.5095767974853516},{"i":837,"loss":2.368551731109619},{"i":836,"loss":2.1557953357696533},{"i":835,"loss":2.597093105316162},{"i":834,"loss":2.3660919666290283},{"i":833,"loss":2.817803382873535},{"i":832,"loss":2.445803165435791},{"i":831,"loss":2.4050679206848145},{"i":830,"loss":2.5576834678649902},{"i":829,"loss":2.841804027557373},{"i":828,"loss":2.469862461090088},{"i":827,"loss":2.9058423042297363},{"i":826,"loss":2.5145726203918457},{"i":825,"loss":2.516697406768799},{"i":824,"loss":2.6703169345855713},{"i":823,"loss":2.4619297981262207},{"i":822,"loss":2.6904830932617188},{"i":821,"loss":2.7701804637908936},{"i":820,"loss":2.907752513885498},{"i":819,"loss":2.59710955619812},{"i":818,"loss":2.6834664344787598},{"i":817,"loss":2.340588092803955},{"i":816,"loss":2.480694055557251},{"i":815,"loss":2.664773941040039},{"i":814,"loss":2.769820213317871},{"i":813,"loss":3.197978973388672},{"i":812,"loss":2.356865882873535},{"i":811,"loss":2.4981725215911865},{"i":810,"loss":2.4016947746276855},{"i":809,"loss":2.373541831970215},{"i":808,"loss":2.716247320175171},{"i":807,"loss":2.742650270462036},{"i":806,"loss":2.7211086750030518},{"i":805,"loss":3.0491602420806885},{"i":804,"loss":2.5607306957244873},{"i":803,"loss":2.9079673290252686},{"i":802,"loss":2.867096185684204},{"i":801,"loss":2.7398715019226074},{"i":800,"loss":2.570844888687134},{"i":799,"loss":2.887577533721924},{"i":798,"loss":2.359243154525757},{"i":797,"loss":2.731234073638916},{"i":796,"loss":2.643427848815918},{"i":795,"loss":2.3499550819396973},{"i":794,"loss":2.673072338104248},{"i":793,"loss":2.667323589324951},{"i":792,"loss":2.7213175296783447},{"i":791,"loss":2.7988593578338623},{"i":790,"loss":2.616192579269409},{"i":789,"loss":2.378845691680908},{"i":788,"loss":2.461158275604248},{"i":787,"loss":2.339372396469116},{"i":786,"loss":2.64078688621521},{"i":785,"loss":2.469567060470581},{"i":784,"loss":2.9822232723236084},{"i":783,"loss":2.5768730640411377},{"i":782,"loss":2.661405563354492},{"i":781,"loss":2.7656123638153076},{"i":780,"loss":2.7101235389709473},{"i":779,"loss":2.734576940536499},{"i":778,"loss":2.685847520828247},{"i":777,"loss":2.6979053020477295},{"i":776,"loss":2.426787853240967},{"i":775,"loss":2.779153823852539},{"i":774,"loss":3.1243560314178467},{"i":773,"loss":2.429187774658203},{"i":772,"loss":2.4598755836486816},{"i":771,"loss":2.8419694900512695},{"i":770,"loss":2.8675692081451416},{"i":769,"loss":2.4379518032073975},{"i":768,"loss":2.1893670558929443},{"i":767,"loss":2.467820882797241},{"i":766,"loss":2.584113597869873},{"i":765,"loss":2.4287118911743164},{"i":764,"loss":2.4251837730407715},{"i":763,"loss":2.6700873374938965},{"i":762,"loss":2.660194158554077},{"i":761,"loss":2.3427281379699707},{"i":760,"loss":2.8360555171966553},{"i":759,"loss":3.043717384338379},{"i":758,"loss":2.3717358112335205},{"i":757,"loss":2.691664218902588},{"i":756,"loss":2.9037857055664062},{"i":755,"loss":2.5203778743743896},{"i":754,"loss":2.5939362049102783},{"i":753,"loss":3.0930609703063965},{"i":752,"loss":2.5259647369384766},{"i":751,"loss":2.565443754196167},{"i":750,"loss":2.68412184715271},{"i":749,"loss":2.5962419509887695},{"i":748,"loss":2.635641098022461},{"i":747,"loss":2.9450292587280273},{"i":746,"loss":2.5677714347839355},{"i":745,"loss":2.804806709289551},{"i":744,"loss":2.535425901412964},{"i":743,"loss":2.830949068069458},{"i":742,"loss":3.2706477642059326},{"i":741,"loss":2.423752546310425},{"i":740,"loss":2.7896461486816406},{"i":739,"loss":2.6326491832733154},{"i":738,"loss":3.078953504562378},{"i":737,"loss":2.7760157585144043},{"i":736,"loss":2.385097026824951},{"i":735,"loss":2.5096118450164795},{"i":734,"loss":2.96791934967041},{"i":733,"loss":2.647099494934082},{"i":732,"loss":2.5248093605041504},{"i":731,"loss":2.4478156566619873},{"i":730,"loss":2.592869520187378},{"i":729,"loss":2.5584356784820557},{"i":728,"loss":2.475939989089966},{"i":727,"loss":2.8740200996398926},{"i":726,"loss":2.6992435455322266},{"i":725,"loss":2.933785915374756},{"i":724,"loss":2.8447797298431396},{"i":723,"loss":2.5582666397094727},{"i":722,"loss":2.5866317749023438},{"i":721,"loss":2.517298460006714},{"i":720,"loss":2.7795448303222656},{"i":719,"loss":2.4914205074310303},{"i":718,"loss":2.486492872238159},{"i":717,"loss":2.8166344165802},{"i":716,"loss":2.576995611190796},{"i":715,"loss":2.4249203205108643},{"i":714,"loss":2.8445684909820557},{"i":713,"loss":2.521251678466797},{"i":712,"loss":2.4708943367004395},{"i":711,"loss":2.496525526046753},{"i":710,"loss":2.230584144592285},{"i":709,"loss":2.7292468547821045},{"i":708,"loss":2.9525146484375},{"i":707,"loss":2.313999652862549},{"i":706,"loss":2.8252949714660645},{"i":705,"loss":2.862102508544922},{"i":704,"loss":2.626568078994751},{"i":703,"loss":2.544344902038574},{"i":702,"loss":2.853638172149658},{"i":701,"loss":2.3856828212738037},{"i":700,"loss":2.548923969268799},{"i":699,"loss":2.6284468173980713},{"i":698,"loss":2.6461181640625},{"i":697,"loss":2.5666706562042236},{"i":696,"loss":2.989266872406006},{"i":695,"loss":2.4249343872070312},{"i":694,"loss":2.82228684425354},{"i":693,"loss":2.4447951316833496},{"i":692,"loss":2.945739269256592},{"i":691,"loss":2.9374024868011475},{"i":690,"loss":2.679058313369751},{"i":689,"loss":2.4615638256073},{"i":688,"loss":2.6791832447052},{"i":687,"loss":2.9137871265411377},{"i":686,"loss":2.342151641845703},{"i":685,"loss":2.5556936264038086},{"i":684,"loss":2.6514008045196533},{"i":683,"loss":3.1870222091674805},{"i":682,"loss":2.663533926010132},{"i":681,"loss":2.5093867778778076},{"i":680,"loss":2.4502079486846924},{"i":679,"loss":2.6187541484832764},{"i":678,"loss":2.600961923599243},{"i":677,"loss":2.788576126098633},{"i":676,"loss":2.9965600967407227},{"i":675,"loss":2.7902300357818604},{"i":674,"loss":2.4834868907928467},{"i":673,"loss":2.4828696250915527},{"i":672,"loss":2.6857385635375977},{"i":671,"loss":2.463914632797241},{"i":670,"loss":2.758232831954956},{"i":669,"loss":2.700664758682251},{"i":668,"loss":2.7056210041046143},{"i":667,"loss":2.446658134460449},{"i":666,"loss":3.0986928939819336},{"i":665,"loss":2.7556982040405273},{"i":664,"loss":2.4474847316741943},{"i":663,"loss":2.4835150241851807},{"i":662,"loss":2.4369564056396484},{"i":661,"loss":2.8206193447113037},{"i":660,"loss":2.381282091140747},{"i":659,"loss":2.6114916801452637},{"i":658,"loss":2.9007182121276855},{"i":657,"loss":2.658658981323242},{"i":656,"loss":2.747659206390381},{"i":655,"loss":2.382857322692871},{"i":654,"loss":2.8207974433898926},{"i":653,"loss":2.863877058029175},{"i":652,"loss":2.726309061050415},{"i":651,"loss":2.4244189262390137},{"i":650,"loss":2.810042381286621},{"i":649,"loss":2.827425956726074},{"i":648,"loss":2.455394983291626},{"i":647,"loss":2.4687366485595703},{"i":646,"loss":2.8043642044067383},{"i":645,"loss":2.7962465286254883},{"i":644,"loss":2.6356594562530518},{"i":643,"loss":2.5963380336761475},{"i":642,"loss":2.5990474224090576},{"i":641,"loss":2.427211046218872},{"i":640,"loss":2.638563394546509},{"i":639,"loss":3.188201665878296},{"i":638,"loss":2.7400503158569336},{"i":637,"loss":3.1167163848876953},{"i":636,"loss":2.48982572555542},{"i":635,"loss":2.8522603511810303},{"i":634,"loss":2.883965253829956},{"i":633,"loss":2.9886624813079834},{"i":632,"loss":3.0986101627349854},{"i":631,"loss":2.587637424468994},{"i":630,"loss":2.998920440673828},{"i":629,"loss":2.916534423828125},{"i":628,"loss":2.657611846923828},{"i":627,"loss":2.595137357711792},{"i":626,"loss":2.9042980670928955},{"i":625,"loss":2.730041027069092},{"i":624,"loss":2.7868261337280273},{"i":623,"loss":2.550584316253662},{"i":622,"loss":2.5511415004730225},{"i":621,"loss":2.526618003845215},{"i":620,"loss":2.3960790634155273},{"i":619,"loss":2.6770167350769043},{"i":618,"loss":2.923123598098755},{"i":617,"loss":2.592902183532715},{"i":616,"loss":2.6592018604278564},{"i":615,"loss":2.978936195373535},{"i":614,"loss":2.549522876739502},{"i":613,"loss":2.291741132736206},{"i":612,"loss":2.908111333847046},{"i":611,"loss":2.9005744457244873},{"i":610,"loss":2.2102530002593994},{"i":609,"loss":2.69353985786438},{"i":608,"loss":2.5204007625579834},{"i":607,"loss":2.8313639163970947},{"i":606,"loss":2.8103840351104736},{"i":605,"loss":2.5516202449798584},{"i":604,"loss":2.77724289894104},{"i":603,"loss":2.798672676086426},{"i":602,"loss":2.896313428878784},{"i":601,"loss":2.6984527111053467},{"i":600,"loss":2.3474059104919434},{"i":599,"loss":2.6192545890808105},{"i":598,"loss":2.9715912342071533},{"i":597,"loss":2.6076929569244385},{"i":596,"loss":2.7170827388763428},{"i":595,"loss":2.9456593990325928},{"i":594,"loss":2.5334832668304443},{"i":593,"loss":2.8137874603271484},{"i":592,"loss":2.6471755504608154},{"i":591,"loss":3.3419981002807617},{"i":590,"loss":2.4603652954101562},{"i":589,"loss":3.0599818229675293},{"i":588,"loss":2.451127767562866},{"i":587,"loss":2.756884813308716},{"i":586,"loss":2.5724377632141113},{"i":585,"loss":2.9925448894500732},{"i":584,"loss":2.911781072616577},{"i":583,"loss":2.919160842895508},{"i":582,"loss":2.859100341796875},{"i":581,"loss":2.8463666439056396},{"i":580,"loss":2.7187650203704834},{"i":579,"loss":2.3479418754577637},{"i":578,"loss":2.620058298110962},{"i":577,"loss":3.134687662124634},{"i":576,"loss":2.581923484802246},{"i":575,"loss":2.902604103088379},{"i":574,"loss":2.8941619396209717},{"i":573,"loss":2.916201114654541},{"i":572,"loss":3.3547754287719727},{"i":571,"loss":2.643378496170044},{"i":570,"loss":2.5426149368286133},{"i":569,"loss":2.7550668716430664},{"i":568,"loss":2.7727160453796387},{"i":567,"loss":2.5129716396331787},{"i":566,"loss":2.8112752437591553},{"i":565,"loss":2.85451340675354},{"i":564,"loss":2.850764751434326},{"i":563,"loss":2.844688892364502},{"i":562,"loss":2.1898818016052246},{"i":561,"loss":2.635131597518921},{"i":560,"loss":2.611722469329834},{"i":559,"loss":3.0826778411865234},{"i":558,"loss":2.460669755935669},{"i":557,"loss":2.6698999404907227},{"i":556,"loss":3.0565037727355957},{"i":555,"loss":2.9146203994750977},{"i":554,"loss":2.789064645767212},{"i":553,"loss":2.880120277404785},{"i":552,"loss":2.441507577896118},{"i":551,"loss":3.1562862396240234},{"i":550,"loss":2.3765599727630615},{"i":549,"loss":3.141977548599243},{"i":548,"loss":2.6214349269866943},{"i":547,"loss":2.756687879562378},{"i":546,"loss":2.3858463764190674},{"i":545,"loss":2.8079090118408203},{"i":544,"loss":2.6521708965301514},{"i":543,"loss":2.523848295211792},{"i":542,"loss":2.809995412826538},{"i":541,"loss":3.1674516201019287},{"i":540,"loss":2.5967230796813965},{"i":539,"loss":2.2830066680908203},{"i":538,"loss":2.958301305770874},{"i":537,"loss":2.6746366024017334},{"i":536,"loss":2.8929266929626465},{"i":535,"loss":2.764350414276123},{"i":534,"loss":2.647407054901123},{"i":533,"loss":2.6489310264587402},{"i":532,"loss":2.5421104431152344},{"i":531,"loss":2.4071524143218994},{"i":530,"loss":3.1026551723480225},{"i":529,"loss":2.807818651199341},{"i":528,"loss":2.696319580078125},{"i":527,"loss":2.812824010848999},{"i":526,"loss":2.6514153480529785},{"i":525,"loss":2.8323071002960205},{"i":524,"loss":2.683603525161743},{"i":523,"loss":2.4816863536834717},{"i":522,"loss":2.621176242828369},{"i":521,"loss":2.3476064205169678},{"i":520,"loss":3.0224642753601074},{"i":519,"loss":3.0622100830078125},{"i":518,"loss":2.4367122650146484},{"i":517,"loss":3.1810309886932373},{"i":516,"loss":2.373218297958374},{"i":515,"loss":2.34257435798645},{"i":514,"loss":3.219054698944092},{"i":513,"loss":2.941725492477417},{"i":512,"loss":2.8597798347473145},{"i":511,"loss":2.858649253845215},{"i":510,"loss":2.665701389312744},{"i":509,"loss":2.7827649116516113},{"i":508,"loss":2.979036808013916},{"i":507,"loss":2.6097185611724854},{"i":506,"loss":2.970057249069214},{"i":505,"loss":2.6014320850372314},{"i":504,"loss":2.89859676361084},{"i":503,"loss":2.8571696281433105},{"i":502,"loss":2.511775255203247},{"i":501,"loss":2.859718084335327},{"i":500,"loss":3.1792163848876953},{"i":499,"loss":2.1844942569732666},{"i":498,"loss":2.3103973865509033},{"i":497,"loss":2.618860960006714},{"i":496,"loss":2.7246296405792236},{"i":495,"loss":2.7116081714630127},{"i":494,"loss":2.692854166030884},{"i":493,"loss":2.968106746673584},{"i":492,"loss":2.9481258392333984},{"i":491,"loss":2.6896376609802246},{"i":490,"loss":3.0439398288726807},{"i":489,"loss":3.1444246768951416},{"i":488,"loss":2.6705269813537598},{"i":487,"loss":3.310338020324707},{"i":486,"loss":2.5084004402160645},{"i":485,"loss":2.4924814701080322},{"i":484,"loss":2.98475980758667},{"i":483,"loss":2.3817169666290283},{"i":482,"loss":2.9364731311798096},{"i":481,"loss":2.8954293727874756},{"i":480,"loss":2.5447945594787598},{"i":479,"loss":2.54738712310791},{"i":478,"loss":3.5220048427581787},{"i":477,"loss":2.501372814178467},{"i":476,"loss":2.571336507797241},{"i":475,"loss":3.0667951107025146},{"i":474,"loss":2.73892879486084},{"i":473,"loss":3.2023186683654785},{"i":472,"loss":2.249253749847412},{"i":471,"loss":2.4263811111450195},{"i":470,"loss":2.6536550521850586},{"i":469,"loss":3.03488826751709},{"i":468,"loss":2.5121707916259766},{"i":467,"loss":2.5398879051208496},{"i":466,"loss":2.806166648864746},{"i":465,"loss":2.4996774196624756},{"i":464,"loss":2.4821550846099854},{"i":463,"loss":2.5397114753723145},{"i":462,"loss":2.7099316120147705},{"i":461,"loss":2.361015796661377},{"i":460,"loss":2.869943857192993},{"i":459,"loss":2.266427993774414},{"i":458,"loss":3.4467098712921143},{"i":457,"loss":2.9562675952911377},{"i":456,"loss":2.58516001701355},{"i":455,"loss":2.5967416763305664},{"i":454,"loss":3.2592718601226807},{"i":453,"loss":2.7250356674194336},{"i":452,"loss":2.9313344955444336},{"i":451,"loss":2.6331658363342285},{"i":450,"loss":2.5658819675445557},{"i":449,"loss":2.5407750606536865},{"i":448,"loss":3.503814697265625},{"i":447,"loss":2.4758338928222656},{"i":446,"loss":2.6813089847564697},{"i":445,"loss":2.841031312942505},{"i":444,"loss":2.9255709648132324},{"i":443,"loss":2.8352103233337402},{"i":442,"loss":2.8543319702148438},{"i":441,"loss":3.0578789710998535},{"i":440,"loss":2.9807138442993164},{"i":439,"loss":3.0875391960144043},{"i":438,"loss":2.594036340713501},{"i":437,"loss":2.2042739391326904},{"i":436,"loss":2.7290587425231934},{"i":435,"loss":2.6612954139709473},{"i":434,"loss":2.747002124786377},{"i":433,"loss":2.7443060874938965},{"i":432,"loss":2.8186326026916504},{"i":431,"loss":2.588257074356079},{"i":430,"loss":2.8938238620758057},{"i":429,"loss":3.099931478500366},{"i":428,"loss":2.464491605758667},{"i":427,"loss":2.324519634246826},{"i":426,"loss":2.505645275115967},{"i":425,"loss":3.0528955459594727},{"i":424,"loss":2.7164411544799805},{"i":423,"loss":2.7600677013397217},{"i":422,"loss":2.3966281414031982},{"i":421,"loss":2.78004789352417},{"i":420,"loss":2.491166591644287},{"i":419,"loss":2.999068021774292},{"i":418,"loss":3.053778886795044},{"i":417,"loss":3.024458408355713},{"i":416,"loss":2.5668587684631348},{"i":415,"loss":2.890477180480957},{"i":414,"loss":3.427391767501831},{"i":413,"loss":2.8891029357910156},{"i":412,"loss":2.7275118827819824},{"i":411,"loss":2.3701441287994385},{"i":410,"loss":2.5253772735595703},{"i":409,"loss":2.8518404960632324},{"i":408,"loss":2.8040103912353516},{"i":407,"loss":2.9392573833465576},{"i":406,"loss":2.4634079933166504},{"i":405,"loss":2.7577462196350098},{"i":404,"loss":2.8539230823516846},{"i":403,"loss":2.9048919677734375},{"i":402,"loss":2.472005605697632},{"i":401,"loss":2.5817267894744873},{"i":400,"loss":2.8598806858062744},{"i":399,"loss":3.009028911590576},{"i":398,"loss":3.185408353805542},{"i":397,"loss":3.150495767593384},{"i":396,"loss":2.939451217651367},{"i":395,"loss":2.367276906967163},{"i":394,"loss":2.716038942337036},{"i":393,"loss":2.659454107284546},{"i":392,"loss":2.896512508392334},{"i":391,"loss":2.7988319396972656},{"i":390,"loss":3.0700390338897705},{"i":389,"loss":2.7506585121154785},{"i":388,"loss":2.5013864040374756},{"i":387,"loss":2.518278121948242},{"i":386,"loss":2.485297203063965},{"i":385,"loss":2.2231178283691406},{"i":384,"loss":2.824198007583618},{"i":383,"loss":3.522852897644043},{"i":382,"loss":2.547330856323242},{"i":381,"loss":2.4643216133117676},{"i":380,"loss":3.126770257949829},{"i":379,"loss":2.8647966384887695},{"i":378,"loss":2.8175466060638428},{"i":377,"loss":2.8297979831695557},{"i":376,"loss":3.040548086166382},{"i":375,"loss":2.6248536109924316},{"i":374,"loss":2.827255964279175},{"i":373,"loss":2.794966220855713},{"i":372,"loss":3.569777488708496},{"i":371,"loss":2.5009922981262207},{"i":370,"loss":2.544342517852783},{"i":369,"loss":2.8559460639953613},{"i":368,"loss":2.882657766342163},{"i":367,"loss":2.546534776687622},{"i":366,"loss":3.2451634407043457},{"i":365,"loss":2.5835652351379395},{"i":364,"loss":2.883207082748413},{"i":363,"loss":2.692697763442993},{"i":362,"loss":3.0277130603790283},{"i":361,"loss":2.2147719860076904},{"i":360,"loss":3.151679277420044},{"i":359,"loss":2.674978017807007},{"i":358,"loss":2.585454225540161},{"i":357,"loss":2.597588062286377},{"i":356,"loss":3.065599203109741},{"i":355,"loss":2.9112887382507324},{"i":354,"loss":2.637856960296631},{"i":353,"loss":2.684035539627075},{"i":352,"loss":2.674976110458374},{"i":351,"loss":2.778243064880371},{"i":350,"loss":2.372654438018799},{"i":349,"loss":2.4790427684783936},{"i":348,"loss":2.456286907196045},{"i":347,"loss":2.5167386531829834},{"i":346,"loss":2.670865058898926},{"i":345,"loss":2.3350868225097656},{"i":344,"loss":2.7405714988708496},{"i":343,"loss":2.8898723125457764},{"i":342,"loss":3.334080934524536},{"i":341,"loss":2.751814842224121},{"i":340,"loss":2.97878098487854},{"i":339,"loss":2.8691091537475586},{"i":338,"loss":2.948955535888672},{"i":337,"loss":2.422776222229004},{"i":336,"loss":2.6476335525512695},{"i":335,"loss":2.6034905910491943},{"i":334,"loss":2.5698864459991455},{"i":333,"loss":2.8393194675445557},{"i":332,"loss":2.713918924331665},{"i":331,"loss":2.540539264678955},{"i":330,"loss":2.6823370456695557},{"i":329,"loss":2.8903088569641113},{"i":328,"loss":2.7896080017089844},{"i":327,"loss":2.623976469039917},{"i":326,"loss":2.809847593307495},{"i":325,"loss":3.279322385787964},{"i":324,"loss":3.1772263050079346},{"i":323,"loss":2.4089033603668213},{"i":322,"loss":2.99570369720459},{"i":321,"loss":2.5693094730377197},{"i":320,"loss":2.7961928844451904},{"i":319,"loss":2.9183313846588135},{"i":318,"loss":2.543602228164673},{"i":317,"loss":2.917196035385132},{"i":316,"loss":2.7561936378479004},{"i":315,"loss":2.8388378620147705},{"i":314,"loss":2.288912057876587},{"i":313,"loss":3.1300699710845947},{"i":312,"loss":2.440368890762329},{"i":311,"loss":3.1650846004486084},{"i":310,"loss":3.1406702995300293},{"i":309,"loss":3.088146448135376},{"i":308,"loss":2.861426591873169},{"i":307,"loss":3.2156639099121094},{"i":306,"loss":2.866370677947998},{"i":305,"loss":3.2167787551879883},{"i":304,"loss":2.4991037845611572},{"i":303,"loss":3.1580097675323486},{"i":302,"loss":2.4828884601593018},{"i":301,"loss":2.387707471847534},{"i":300,"loss":3.3173627853393555},{"i":299,"loss":2.4731802940368652},{"i":298,"loss":3.079850435256958},{"i":297,"loss":2.6404025554656982},{"i":296,"loss":2.618349313735962},{"i":295,"loss":2.619722366333008},{"i":294,"loss":3.2600245475769043},{"i":293,"loss":2.536160707473755},{"i":292,"loss":2.918728828430176},{"i":291,"loss":2.6348392963409424},{"i":290,"loss":3.1964540481567383},{"i":289,"loss":2.542351245880127},{"i":288,"loss":2.7336385250091553},{"i":287,"loss":3.0817313194274902},{"i":286,"loss":3.385725259780884},{"i":285,"loss":2.3197319507598877},{"i":284,"loss":2.673414468765259},{"i":283,"loss":2.4159390926361084},{"i":282,"loss":3.334569215774536},{"i":281,"loss":3.0503313541412354},{"i":280,"loss":2.931464433670044},{"i":279,"loss":2.7803287506103516},{"i":278,"loss":3.5943603515625},{"i":277,"loss":3.04262638092041},{"i":276,"loss":2.9910786151885986},{"i":275,"loss":2.3531315326690674},{"i":274,"loss":3.1141180992126465},{"i":273,"loss":2.9510040283203125},{"i":272,"loss":3.1306817531585693},{"i":271,"loss":3.1539552211761475},{"i":270,"loss":2.678252935409546},{"i":269,"loss":3.2554361820220947},{"i":268,"loss":2.962975025177002},{"i":267,"loss":2.3890485763549805},{"i":266,"loss":2.985288619995117},{"i":265,"loss":2.7696385383605957},{"i":264,"loss":2.9407758712768555},{"i":263,"loss":2.5929923057556152},{"i":262,"loss":2.8324525356292725},{"i":261,"loss":3.6352932453155518},{"i":260,"loss":2.692671775817871},{"i":259,"loss":2.9910025596618652},{"i":258,"loss":3.0974230766296387},{"i":257,"loss":2.8237695693969727},{"i":256,"loss":2.864851236343384},{"i":255,"loss":2.7685561180114746},{"i":254,"loss":3.209742784500122},{"i":253,"loss":2.670323133468628},{"i":252,"loss":2.6602258682250977},{"i":251,"loss":3.0087809562683105},{"i":250,"loss":3.161224126815796},{"i":249,"loss":2.8989171981811523},{"i":248,"loss":2.681389570236206},{"i":247,"loss":3.184835910797119},{"i":246,"loss":3.381132125854492},{"i":245,"loss":2.7162885665893555},{"i":244,"loss":2.8461034297943115},{"i":243,"loss":2.6359691619873047},{"i":242,"loss":3.2678425312042236},{"i":241,"loss":2.9679136276245117},{"i":240,"loss":2.9002175331115723},{"i":239,"loss":2.562629461288452},{"i":238,"loss":2.4264252185821533},{"i":237,"loss":2.9204189777374268},{"i":236,"loss":3.008288621902466},{"i":235,"loss":2.7182183265686035},{"i":234,"loss":3.1369776725769043},{"i":233,"loss":2.9064505100250244},{"i":232,"loss":3.156696081161499},{"i":231,"loss":3.0639379024505615},{"i":230,"loss":3.582695484161377},{"i":229,"loss":2.933480978012085},{"i":228,"loss":2.9341838359832764},{"i":227,"loss":2.883004903793335},{"i":226,"loss":2.933643341064453},{"i":225,"loss":3.0604798793792725},{"i":224,"loss":3.301863670349121},{"i":223,"loss":2.291672468185425},{"i":222,"loss":2.7497448921203613},{"i":221,"loss":2.4447596073150635},{"i":220,"loss":2.7760751247406006},{"i":219,"loss":2.9975855350494385},{"i":218,"loss":2.687324285507202},{"i":217,"loss":2.6198182106018066},{"i":216,"loss":3.25227952003479},{"i":215,"loss":2.733675479888916},{"i":214,"loss":2.808049201965332},{"i":213,"loss":3.287395715713501},{"i":212,"loss":3.039660692214966},{"i":211,"loss":2.831043004989624},{"i":210,"loss":3.1051442623138428},{"i":209,"loss":3.738443374633789},{"i":208,"loss":3.727832317352295},{"i":207,"loss":3.0819172859191895},{"i":206,"loss":3.043569803237915},{"i":205,"loss":3.2243080139160156},{"i":204,"loss":3.106823444366455},{"i":203,"loss":3.373964309692383},{"i":202,"loss":3.193167209625244},{"i":201,"loss":2.4371752738952637},{"i":200,"loss":2.8975720405578613},{"i":199,"loss":3.442739486694336},{"i":198,"loss":3.080044984817505},{"i":197,"loss":2.9001035690307617},{"i":196,"loss":3.028794050216675},{"i":195,"loss":3.516169309616089},{"i":194,"loss":3.317901849746704},{"i":193,"loss":2.624488592147827},{"i":192,"loss":2.8778839111328125},{"i":191,"loss":2.8618087768554688},{"i":190,"loss":3.0342230796813965},{"i":189,"loss":2.8464879989624023},{"i":188,"loss":3.313767194747925},{"i":187,"loss":3.2479465007781982},{"i":186,"loss":3.083458423614502},{"i":185,"loss":2.8798155784606934},{"i":184,"loss":2.7131290435791016},{"i":183,"loss":2.5945615768432617},{"i":182,"loss":2.8830924034118652},{"i":181,"loss":2.7357795238494873},{"i":180,"loss":3.273732900619507},{"i":179,"loss":3.102454900741577},{"i":178,"loss":3.0463428497314453},{"i":177,"loss":3.156029224395752},{"i":176,"loss":2.859405755996704},{"i":175,"loss":2.6442646980285645},{"i":174,"loss":2.726555109024048},{"i":173,"loss":3.2107417583465576},{"i":172,"loss":2.962959051132202},{"i":171,"loss":2.9542429447174072},{"i":170,"loss":3.2493174076080322},{"i":169,"loss":2.7670018672943115},{"i":168,"loss":2.9865334033966064},{"i":167,"loss":3.020611524581909},{"i":166,"loss":3.307403802871704},{"i":165,"loss":3.0636823177337646},{"i":164,"loss":2.9423892498016357},{"i":163,"loss":2.9076061248779297},{"i":162,"loss":2.8125433921813965},{"i":161,"loss":2.7796108722686768},{"i":160,"loss":3.1708128452301025},{"i":159,"loss":2.9245080947875977},{"i":158,"loss":3.17173433303833},{"i":157,"loss":3.2736337184906006},{"i":156,"loss":3.371626853942871},{"i":155,"loss":3.38866925239563},{"i":154,"loss":3.3892853260040283},{"i":153,"loss":3.3675739765167236},{"i":152,"loss":2.6474099159240723},{"i":151,"loss":3.0109026432037354},{"i":150,"loss":3.505002975463867},{"i":149,"loss":3.2829971313476562},{"i":148,"loss":3.594066858291626},{"i":147,"loss":3.095916271209717},{"i":146,"loss":3.227008819580078},{"i":145,"loss":3.039271593093872},{"i":144,"loss":2.864283323287964},{"i":143,"loss":3.003579616546631},{"i":142,"loss":3.0699517726898193},{"i":141,"loss":3.291565179824829},{"i":140,"loss":3.84462833404541},{"i":139,"loss":3.085521697998047},{"i":138,"loss":3.2260472774505615},{"i":137,"loss":3.0752224922180176},{"i":136,"loss":2.8514647483825684},{"i":135,"loss":3.7995357513427734},{"i":134,"loss":2.908839225769043},{"i":133,"loss":2.919264554977417},{"i":132,"loss":3.087630033493042},{"i":131,"loss":2.823333740234375},{"i":130,"loss":4.153954982757568},{"i":129,"loss":3.1068711280822754},{"i":128,"loss":3.828557014465332},{"i":127,"loss":3.443824291229248},{"i":126,"loss":3.4209189414978027},{"i":125,"loss":3.2891740798950195},{"i":124,"loss":3.460026264190674},{"i":123,"loss":3.198028802871704},{"i":122,"loss":3.982001543045044},{"i":121,"loss":2.6947269439697266},{"i":120,"loss":3.198643922805786},{"i":119,"loss":2.8571348190307617},{"i":118,"loss":3.0106699466705322},{"i":117,"loss":2.5704269409179688},{"i":116,"loss":3.7645394802093506},{"i":115,"loss":3.9397799968719482},{"i":114,"loss":3.6144778728485107},{"i":113,"loss":3.7384955883026123},{"i":112,"loss":2.770857334136963},{"i":111,"loss":3.810131311416626},{"i":110,"loss":3.418355941772461},{"i":109,"loss":3.544395923614502},{"i":108,"loss":2.9393222332000732},{"i":107,"loss":3.3799214363098145},{"i":106,"loss":4.237447738647461},{"i":105,"loss":3.2590298652648926},{"i":104,"loss":4.001921653747559},{"i":103,"loss":2.7824320793151855},{"i":102,"loss":3.1480865478515625},{"i":101,"loss":2.812171697616577},{"i":100,"loss":2.924705982208252},{"i":99,"loss":3.2741904258728027},{"i":98,"loss":3.419058322906494},{"i":97,"loss":3.9709367752075195},{"i":96,"loss":2.9852936267852783},{"i":95,"loss":3.508894920349121},{"i":94,"loss":3.499371290206909},{"i":93,"loss":3.130897283554077},{"i":92,"loss":3.875138282775879},{"i":91,"loss":3.206737995147705},{"i":90,"loss":3.495357036590576},{"i":89,"loss":3.5811257362365723},{"i":88,"loss":4.761239051818848},{"i":87,"loss":4.373218536376953},{"i":86,"loss":4.232020854949951},{"i":85,"loss":4.01233434677124},{"i":84,"loss":3.3541855812072754},{"i":83,"loss":3.4175384044647217},{"i":82,"loss":4.06196403503418},{"i":81,"loss":4.091588497161865},{"i":80,"loss":3.958872079849243},{"i":79,"loss":3.023160696029663},{"i":78,"loss":3.881558656692505},{"i":77,"loss":3.405194044113159},{"i":76,"loss":3.0785937309265137},{"i":75,"loss":3.6811881065368652},{"i":74,"loss":3.2198240756988525},{"i":73,"loss":4.11869478225708},{"i":72,"loss":2.8298304080963135},{"i":71,"loss":3.139143466949463},{"i":70,"loss":5.327495098114014},{"i":69,"loss":3.6005356311798096},{"i":68,"loss":4.086650371551514},{"i":67,"loss":4.270678520202637},{"i":66,"loss":3.949799060821533},{"i":65,"loss":4.368233680725098},{"i":64,"loss":3.909982442855835},{"i":63,"loss":3.8285884857177734},{"i":62,"loss":3.390087604522705},{"i":61,"loss":4.340004920959473},{"i":60,"loss":4.188059329986572},{"i":59,"loss":3.2162904739379883},{"i":58,"loss":4.573533058166504},{"i":57,"loss":3.0882441997528076},{"i":56,"loss":3.52850604057312},{"i":55,"loss":5.2247514724731445},{"i":54,"loss":4.005434513092041},{"i":53,"loss":3.974094867706299},{"i":52,"loss":4.15694522857666},{"i":51,"loss":4.142610549926758},{"i":50,"loss":4.127119064331055},{"i":49,"loss":4.142237663269043},{"i":48,"loss":3.3916049003601074},{"i":47,"loss":2.873777389526367},{"i":46,"loss":4.507948875427246},{"i":45,"loss":4.078605651855469},{"i":44,"loss":3.9224581718444824},{"i":43,"loss":4.0289530754089355},{"i":42,"loss":5.46935510635376},{"i":41,"loss":4.581313133239746},{"i":40,"loss":3.8893988132476807},{"i":39,"loss":5.1046366691589355},{"i":38,"loss":4.1015424728393555},{"i":37,"loss":5.615957260131836},{"i":36,"loss":4.194202423095703},{"i":35,"loss":5.374715328216553},{"i":34,"loss":4.666234016418457},{"i":33,"loss":5.633865833282471},{"i":32,"loss":4.20794153213501},{"i":31,"loss":6.862722873687744},{"i":30,"loss":4.246102333068848},{"i":29,"loss":4.852039337158203},{"i":28,"loss":5.6273980140686035},{"i":27,"loss":6.229104042053223},{"i":26,"loss":7.198392868041992},{"i":25,"loss":5.418586254119873},{"i":24,"loss":4.835270404815674},{"i":23,"loss":6.384893417358398},{"i":22,"loss":5.506619930267334},{"i":21,"loss":5.230271339416504},{"i":20,"loss":5.236379623413086},{"i":19,"loss":6.794472694396973},{"i":18,"loss":8.441896438598633},{"i":17,"loss":8.215203285217285},{"i":16,"loss":9.885676383972168},{"i":15,"loss":9.424250602722168},{"i":14,"loss":7.381310939788818},{"i":13,"loss":7.682611465454102},{"i":12,"loss":8.567580223083496},{"i":11,"loss":9.402350425720215},{"i":10,"loss":8.392766952514648},{"i":9,"loss":9.321432113647461},{"i":8,"loss":11.43310832977295},{"i":7,"loss":12.224029541015625},{"i":6,"loss":11.172513961791992},{"i":5,"loss":12.153496742248535},{"i":4,"loss":11.272292137145996},{"i":3,"loss":14.451898574829102},{"i":2,"loss":10.812154769897461},{"i":1,"loss":14.440353393554688}]},"encoding":{"x":{"field":"i","type":"quantitative"},"y":{"field":"loss","type":"quantitative"}},"height":400,"mark":{"fillOpacity":1,"type":"line"},"width":800}
```
